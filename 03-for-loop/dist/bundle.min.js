!function(t){var n={};function e(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,e),o.l=!0,o.exports}e.m=t,e.c=n,e.d=function(t,n,r){e.o(t,n)||Object.defineProperty(t,n,{enumerable:!0,get:r})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,n){if(1&n&&(t=e(t)),8&n)return t;if(4&n&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(e.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&n&&"string"!=typeof t)for(var o in t)e.d(r,o,function(n){return t[n]}.bind(null,o));return r},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},e.p="",e(e.s=0)}([function(t,n,e){"use strict";function r(t){return typeof t}function o(t){return"object"===r(t)}function s(t){return"string"===r(t)}function i(t){return Array.isArray(t)}function u(t){return"function"===r(t)}function c(t,n){return t instanceof n}function h(t,n){return t.indexOf(n)}function l(t){return window.Symbol(t)}function f(t){throw t&&console.error(t),new Error("assert failed!")}function a(t,n,e=0){return t.startsWith(n,e)}e.r(n);const p="default",d="empty";const m=l(),g=l(),w=l(),b=l(),y=l(),x=l(),E=l(),v=l();function _(t,n,e=0,r=!1){const o=n.length-1;if(o<0)return null;const s=""+n[e];if(a(s,"_"))return console.error('WARN: property name startsWith char "_" is private/once-used property, ignored get/set listener.'),null;let i=t[s];if(!i){if(!r)return null;i=t[s]=Object.create(null),Object.assign(i,{[x]:null,[E]:[],[v]:Object.create(null)})}return o===e?i:_(i[v],n,e+1,r)}function k(t,n,e){const r=i(n)?n:n.split(".");if(0===r.length)return;const o=_(t[y],r,0,!0);var s,u;h(s=o[E],u=e)>=0||s.push(u)}function j(t,n,e){const r=i(n)?n:n.split(".");if(0===r.length)return;const o=_(t[y],r,0,!1);o&&(e?function(t,n){const e=h(t,n);e<0||t.splice(e,1)}(o[E],e):o[E].length=0)}function O(t){!function(t){for(const n in t){const e=t[n];if(!(x in e))return;e[x]&&(M(e[x]),e[x]=null),e[E].length=0,O(e[v]),e[v]=null,t[n]=null}}(t[y])}const C=window.setImmediate||window.setTimeout,M=window.clearImmediate||window.clearTimeout;function S(t,n){const e=i(n)?n:n.split(".");if(0===e.length)return;const r=_(t[y],e,0,!1);r&&function t(n){n[x]&&(M(n[x]),n[x]=null),n[E].length>0&&(n[x]=C(()=>{n[x]=null,n[E].forEach(t=>t())}));const e=n[v];for(const n in e)t(e[n])}(r)}const N=l(),P=[];function $(t){return null!==t&&o(t)&&N in t}function A(t,n,e){const r=t[N];for(let t=0;t<r.length;t++)if(r[t][0]===n&&r[t][1]===e)return;r.push([n,e])}function T(t,n,e){const r=t[N];for(let t=0;t<r.length;t++)if(r[t][0]===n&&r[t][1]===e)return void r.splice(t,1)}function F(t,n){m in t&&t[m](n),t[N].forEach(t=>{const[e,r]=t;F(e,i(n)?[r,...n]:[r,n])})}function I(t,n,e){if(!s(o=n)||a(o,"_"))return t[n]=e,!0;var o;const i=r(e),u=$(e);if(null!==e&&"object"===i&&!u)throw new Error("public property of ViewModel target must also be ViewModel");const c=t[n];return $(c)&&T(c,t,n),t[n]=e,u&&A(e,t,n),F(t,n),!0}const R={set:I},D={push:2,pop:2,shift:2,unshift:2,splice:3,reverse:2,sort:2,fill:2,slice:1,concat:1,map:1},B={get(t,n){if(n in D){const e=D[n],r=t[n];return function(...n){const o=r.call(t,...n);return(2&e)>0&&t[N].forEach(t=>F(t[0],t[1])),(1&e)>0&&i(o)&&!(N in o)?L(o):o}}return t[n]},set:function(t,n,e){return"length"===n?function(t,n){if("number"!==r(e=n)||Number.isNaN(e)||!Number.isFinite(e))throw new Error("bad argument. array length must be validate number.");var e;const o=t.length;if(o>n)for(let e=n;e<o;e++){const n=t[e];$(n)&&T(n,t,e)}return t.length=n,o!==n&&t[N].forEach(t=>F(t[0],t[1])),!0}(t,e):I(t,n,e)}};function V(t,n){const e=t[n];null===e||"object"!==r(e)||N in e||(c(e,Boolean)||c(e,RegExp)?e[N]=P:(t[n]=L(e),A(e,t,n)))}function W(t,n,e){return t[N]=[],e&&function(t){y in t||(t[y]={},t[g]=((n,e)=>k(t,n,e)),t[w]=((n,e)=>j(t,n,e)),t[m]=(n=>S(t,n)),t[b]=(()=>O(t)))}(t),new Proxy(t,n?B:R)}function L(t,n=!1){if(null===t)return t;if("object"!==r(t))return t;if(N in t)return t;if(!c(t,Boolean)&&!c(t,RegExp)){if(i(t)){for(let n=0;n<t.length;n++)V(t,n);return W(t,!0,n)}for(const n in t)V(t,n);return W(t,!1,n)}t[N]=P}function q(t){return new Proxy(t,R)}const z=l();class G{constructor(){this[z]=null}notify(t,...n){!function(t,n,...e){if(!t)return;const r=t.get(n);r&&r.forEach(t=>t(...e))}(this[z],t,...n)}on(t,n){const e=this;e[z]||(e[z]=new Map),function(t,n,e){let r=t.get(n);r||(r=[],t.set(n,r)),r.indexOf(e)<0&&r.push(e)}(e[z],t,n)}off(t,n){!function(t,n,e){if(!t)return;if(!n)return t.forEach(t=>t.length=0),void t.clear();const r=t.get(n);if(!r)return;if(!e)return void(r.length=0);const o=r.indexOf(e);o<0||r.splice(o,1)}(this[z],t,n)}clear(t){var n,e;n=this[z],e=t,n&&(e?n.delete(e):n.clear())}}function J(t){return t.parentNode}function K(t,n){t.textContent=n}function U(t,n,...e){const r=document.createElement(t);if(n)for(const t in n)o=r,s=t,i=n[t],o.setAttribute(s,i);var o,s,i;return e.forEach(t=>et(r,t)),r}function X(t,...n){return U(t,null,...n)}function H(t){const n=document.createDocumentFragment();return t&&t.forEach(t=>et(n,t)),n}function Q(t){return document.createTextNode(t)}function Y(t){return document.createComment(t)}function Z(t){return i(t)?0===t.length?null:1===t.length?t[0]:H(t):t}function tt(t,n,e){(n=Z(n))&&t.insertBefore(n,e)}function nt(t,n){t.removeChild(n)}function et(t,...n){n.forEach(n=>{if(i(n))return n.forEach(n=>et(t,n));s(n)&&(n=Q(n)),t.appendChild(n)})}function rt(t,n,e,r=!1){t.addEventListener(n,e,r)}l();const ot=l(),st=l(),it=l(),ut=l(),ct=l(),ht=l(),lt=l(),ft=l(),at=l(),pt=l(),dt=l(),mt=l(),gt=l(),wt=l(),bt=l(),yt=l(),xt=0,Et=1,vt=2,_t=4,kt=["initialize","rendered","willdestroy","destroied"];function jt(t){Ct(t)&&(t[ft].forEach(jt),t[at].forEach(jt),t[yt]=Et,t[lt]=-1,t.afterRender())}class Ot extends G{static get template(){return null}constructor(t){if(null==t);else if(u(t))t={[it]:{[p]:t}};else if(o(t)&&!(N in t))throw new Error("First argument passed to Component constructor must be ViewModel");super(),this[N]=P,this[y]={},this[ht]=t?t[ht]:null,this[lt]=0,this[it]=t&&t[it]||null,this[yt]=xt,this[ft]=[],this[at]=[],this[pt]={},this[dt]=new Map}[g](t,n,e){k(this,t,n),e&&Ct(e)&&e!==this&&e[mt](this,t,n)}[mt](t,n,e){let r=this[dt].get(t);r||(r=[],this[dt].set(t,r)),r.push([n,e])}[w](t,n){return j(this,t,n)}[b](){O(this)}[m](t){return S(this,t)}[ut](){throw new Error("abstract method")}[ot](){let t=this.constructor.template;return!t&&this[it]&&(t=this[it][p]),u(t)||f(),t(this)}[st](t){var n,e,r;c(t,Node)||f(),this[yt]!==xt&&f(),n=J(t),e=this[ot](),r=t,(e=Z(e))&&n.replaceChild(e,r),jt(this)}[ct](t=!0){var n;this[yt]>vt||(this[yt]=vt,this.beforeDestroy(),super.clear(),this[b](),(n=this)[dt].forEach((t,n)=>{t.forEach(t=>{n[w](t[0],t[1])}),t.length=0}),n[dt].clear(),this[at].forEach(t=>{t[ct](!1)}),this[ft].forEach(t=>{Ct(t)&&t[ct](!1)}),this[yt]=_t,this[dt]=this[at]=this[pt]=this[it]=this[ht]=null,t&&function t(n,e){n[ft].forEach(n=>{Ct(n)?t(n,e):(e||(e=J(n)),nt(e,n))}),n[ft]=null}(this))}[bt](){this[yt]===Et&&this[wt]()}[wt](){throw new Error("abstract method")}[gt](){return kt[this[yt]]}setContext(t,n,e=!1){if(this[lt]<0)throw new Error("Can't setContext after component has been rendered. Try put setContext code into constructor.");var r;if(0===this[lt]&&(this[ht]?this[ht]=(r=this[ht])?Object.assign({},r):null:this[ht]={},this[lt]=1),t in this[ht]&&!e)throw new Error(`Contenxt with id: ${t} is exist. Pass third argument forceOverride=true to override it.`);this[ht][t]=n}getContext(t){return this[ht]&&this[ht][t]||null}getChild(t){return this[pt][t]||null}afterRender(){}beforeDestroy(){}}function Ct(t){return c(t,Ot)}function Mt(t){if(!i(t)||0===t.length)throw new Error("Render results of component is empty");return t}function St(t){const n=t[ft];return n&&0!==n.length||f(),Ct(n[0])?St(n[0]):n[0]}const Nt=l("length"),Pt=l("keys"),$t=l("key"),At="index",Tt="each",Ft=[];class It extends Ot{constructor(t,n,e){super(t);const r=q(this);return r.each=n,r.index=e,r}[ot](){const t=this[it][p];return t||f(),t(this)}}function Rt(t,n,e,r){const o=new It(e,t,n);return r.push(o),o[ot]()}function Dt(t,n){if(null!==t&&o(t)&&!(N in t))throw new Error(`<for>: array item [${n}] must be ViewModel.`)}function Bt(t,n,e,r){const o=r===Tt?t:r(t);return e.has(o)&&console.error(`<for>: array item [${n}] and [${e.get(o)}] both have key '${o}', dulplicated key may cause update error.`),e.set(o,n),o}function Vt(t,n,e,r,o){const s=[],i=new Map;return t.forEach((t,u)=>{Dt(t,u),o!==At&&r.push(Bt(t,u,i,o)),s.push(...Rt(t,u,n,e))}),s}function Wt(t,n){n[ft].forEach(n=>{Ct(n)?Wt(t,n):et(t,n)})}class Lt extends Ot{constructor(t){const n=t._key;if(!n)throw new Error('<for>: require "_key" attribute.');if(!n||!/^(index|each(.[\w\d$_]+)*)$/.test(n))throw new Error('<for>: bad "_key" attribute value. See https://[todo]');super(t);const e=q(this),r=()=>{e.loop=t.loop};return r(),t[g]("loop",r),e[$t]=t._key,e[Nt]=0,e[Pt]=null,n!==At&&n!==Tt&&(e[$t]=new Function(Tt,`return ${n}`)),e}get loop(){return this._l}set loop(t){this._l=t,this[bt]()}[ot](){const t=this[ft],n=this[it]?this[it][p]:null;if(!n)return t.push(Y(d)),t;const e=this.loop,r=this[$t];return r!==At&&(this[Pt]=[]),i(e)&&0!==e.length?(this[Nt]=e.length,Vt(e,n,t,this[Pt],r)):(t.push(Y(d)),t)}[wt](){const t=this[it]?this[it][p]:null;if(!t)return;const n=Array.isArray(this.loop)?this.loop:Ft,e=this[ft],r=n.length,o=this[Nt];if(0===r&&0===o)return;const s=this[$t];if(0===r&&o>0){const t=St(e[0]),n=Y(d);tt(J(t),n,t);for(let t=0;t<o;t++)e[t][ct]();return e.length=1,e[0]=n,s!==At&&(this[Pt].length=0),void(this[Nt]=0)}this[Nt]=r;const i=J(0===o?e[0]:St(e[0]));if(0===o&&(nt(i,e[0]),e.length=0),s===At){let s=null;for(let i=0;i<r;i++)if(i<o){const t=e[i];n[i]!==t.each&&(t.each=n[i])}else s||(s=H()),et(s,...Rt(n[i],i,t,e));if(s&&et(i,s),r>=o)return;for(let t=r;t<o;t++)e[t][ct]();return void e.splice(r)}const u=this[Pt];if(0===o){return void et(i,H(Vt(n,t,e,u,s)))}const c=new Map;u.forEach((t,n)=>{c.set(t,n)});const h=[],l=new Map;n.forEach((t,n)=>{Dt(t,n),h.push(Bt(t,n,l,s))});let a=0,m=0;const g=[],w=new Uint8Array(o);for(;a<o||m<r;){for(;a<o;)if(0!==w[a])a++;else{if(l.has(u[a])&&l.get(u[a])>=m)break;e[a][ct](),a++}if(a>=o){let e=null;for(;m<r;m++){const r=new It(t,n[m],m);e||(e=H()),et(e,...r[ot]()),g.push(r)}e&&et(i,e);break}const s=u[a];let p=null;for(;m<r;){const r=h[m];if(r===s)break;let o=null;if(c.has(r)){const t=c.get(r);t>a&&0===w[t]&&(o=e[t],w[t]=1)}p||(p=H()),o?(Wt(p,o),o.index!==m&&(o.index=m),o.each!==n[m]&&(o.each=n[m])):et(p,...(o=new It(t,n[m],m))[ot]()),g.push(o),m++}m>=r&&f("unimpossible?!");const d=e[a];p&&tt(i,p,St(d)),d.index!==m&&(d.index=m),d.each!==n[m]&&(d.each=n[m]),g.push(d),a++,m++}this[ft]=g,this[Pt]=h}}function qt(t,n){return t?n in t?t[n]:t[p]:null}function zt(t,n,e){const r=qt(t,e);if(!r)return n.push(Y(d)),n;const o=new Ot(r);return n.push(o),o[ot]()}function Gt(t,n,e){const r=qt(t,e);if(!r){const t=n[0];if(Ct(t)){const e=St(t),r=J(e),o=Y(d);n[0]=o,tt(r,o,e),t[ct]()}return}const o=n[0];let s,i;const u=Ct(o);u?i=J(s=St(o)):(s=o,i=J(o));const c=new Ot(r);n[0]=c,tt(i,c[ot](),s),u?o[ct]():nt(i,s),jt(c)}class Jt extends Ot{constructor(t){super(t);const n=q(this),e=()=>{n.expect=!!t.expect};return e(),t[g]("expect",e),n}get expect(){return this._e}set expect(t){this._e!==t&&(this._e=t,this[bt]())}[ot](){const t=this[it];return t&&(t[!1]=t.else),zt(t,this[ft],this.expect)}[wt](){Gt(this[it],this[ft],this.expect)}}var Kt=function(t){const n=t;return[(()=>{const n=X("h2","Simple For-loop");return t[ft].push(n),n})(),(()=>{const e=X("div",X("p",...(()=>{const e=L({[ht]:t[ht],loop:null,_key:"index",[it]:{[p]:function(t){const n=t;return[(()=>{const e=Q(""),r=()=>K(e,n.index);return n[g]("index",r,t),r(),t[ft].push(e),e})(),(()=>{const n=Q(": ");return t[ft].push(n),n})(),(()=>{const e=Q(""),r=()=>K(e,n.each);return n[g]("each",r,t),r(),t[ft].push(e),e})(),(()=>{const n=Q(";\n  ");return t[ft].push(n),n})()]}}},!0),r=()=>e.loop=n.numbers;n[g]("numbers",r,t),r();const o=new Lt(e);return t[at].push(o),Mt(o[ot](t))})()),X("div",(()=>{const t=X("button","Test");return rt(t,"click",function(...t){n.test()}),t})(),(()=>{const t=X("button","Push Large");return rt(t,"click",function(...t){n.push()}),t})()));return t[ft].push(e),e})(),(()=>{const n=X("h2","For & If");return t[ft].push(n),n})(),(()=>{const e=X("div",X("p",...(()=>{const e=L({[ht]:t[ht],loop:null,_key:"each",[it]:{[p]:function(t){const n=t;return[...(()=>{const e=L({[ht]:t[ht],expect:null,[it]:{[p]:function(t){return[(()=>{const e=U("span",{style:"margin-right: 10px;"},(()=>{const e=Q(""),r=()=>K(e,n.index);return n[g]("index",r,t),r(),e})(),": ",(()=>{const e=Q(""),r=()=>K(e,n.each);return n[g]("each",r,t),r(),e})(),";");return t[ft].push(e),e})()]}}},!0),r=()=>e.expect=n.each%2==0;n[g]("each",r,t),r();const o=new Jt(e);return t[ft].push(o),Mt(o[ot](t))})(),...(()=>{const e=L({[ht]:t[ht],expect:null,[it]:{[p]:function(t){return[(()=>{const e=U("span",{style:"margin-right: 10px; color: blue;"},(()=>{const e=Q(""),r=()=>K(e,n.each);return n[g]("each",r,t),r(),e})());return t[ft].push(e),e})()]}}},!0),r=()=>e.expect=n.each%2==1;n[g]("each",r,t),r();const o=new Jt(e);return t[ft].push(o),Mt(o[ot](t))})()]}}},!0),r=()=>e.loop=n.numbers;n[g]("numbers",r,t),r();const o=new Lt(e);return t[at].push(o),Mt(o[ot](t))})()));return t[ft].push(e),e})(),(()=>{const n=X("h2","Key: id");return t[ft].push(n),n})(),(()=>{const e=X("div",X("p",X("ul",...(()=>{const e=L({[ht]:t[ht],loop:null,_key:"each.id",[it]:{[p]:function(t){const n=t;return[(()=>{const e=X("li",(()=>{const e=Q(""),r=()=>K(e,n.each.name);return n[g]("each.name",r,t),r(),e})());return t[ft].push(e),e})()]}}},!0),r=()=>e.loop=n.persons;n[g]("persons",r,t),r();const o=new Lt(e);return t[at].push(o),Mt(o[ot](t))})())));return t[ft].push(e),e})()]};let Ut=6;!function(t,n){if(n===document.body)throw new Error("bootstrap dom cannot be document.body");const e=new t;Ct(e)||f(),e[st](n)}(class extends Ot{static get template(){return Kt}constructor(t){super(t);const n=q(this);return n.INC=10,n.numbers=L([0,1,2]),n.persons=L([{id:"001",name:"XiaoGe"},{id:"002",name:"Jinge"}]),setInterval(()=>{n.numbers.push(Ut++),n.persons.push(L({id:Date.now().toString(32),name:Date.now().toString(32)}))},3e3),n}test(){this.numbers=L([6,0,7,3,2]),this.persons.length=0}push(){const t=[];for(let n=0;n<1e4;n++)t.push(Ut++);this.numbers.push(...t)}},document.getElementById("root-app"))}]);
//# sourceMappingURL=bundle.min.js.map