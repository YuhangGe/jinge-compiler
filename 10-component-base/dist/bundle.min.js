!function(t){var e={};function n(r){if(e[r])return e[r].exports;var s=e[r]={i:r,l:!1,exports:{}};return t[r].call(s.exports,s,s.exports,n),s.l=!0,s.exports}n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)n.d(r,s,function(e){return t[e]}.bind(null,s));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="dist",n(n.s=0)}([function(t,e,n){"use strict";function r(t){return typeof t}function s(t){return null!==t&&"object"===r(t)}function o(t){return"string"===r(t)}function i(t){return"undefined"===r(t)}function c(t){return Array.isArray(t)}function a(t){return"function"===r(t)}function l(t,e){const n=t.indexOf(e);return!(n<0)&&(t.splice(n,1),!0)}n.r(e);let _=0;function u(){return Date.now().toString(32)+"-"+Math.floor(16777215*Math.random()).toString(32)+"-"+(_++).toString(32)}let d,h,f=0,p=1,g=!1;function m(t){d.delete(t)}function E(t){if(g)return void setTimeout(E,0,t);const e=d.get(t);if(e){g=!0;try{e()}finally{m(t),g=!1}}}if(i(window.setImmediate)){d=new Map;const t="setImmediate$"+(f++).toString(32)+"$";window.addEventListener("message",e=>{e.source===window&&o(e.data)&&e.data.startsWith(t)&&E(Number(e.data.slice(t.length)))},!1),h=function(e){window.postMessage(t+e,"*")}}const y=window.setImmediate||function(t){if(!a(t)||arguments.length>1)throw new Error("setImmediate require callback function.");return d.set(p,t),h(p),p++},w=window.clearImmediate||m;function x(t,e){o(e)||(e=JSON.stringify(e)),t.textContent=e}function D(t=""){return document.createTextNode(o(t)?t:JSON.stringify(t))}function O(t){const e=document.createDocumentFragment();return t&&t.forEach(t=>{e.appendChild(o(t)?document.createTextNode(t):t)}),e}function b(t,e){t.appendChild(O(e))}function N(t,e,n){if(e)if(s(e))for(const n in e)N(t,n,e[n]);else i(n)||null===n?function t(e,n){if(n){if(!s(n))return e.removeAttribute(n);for(const r in n)t(e,r)}}(t,e):t.setAttribute(e,n)}function R(t,e,n){if(e)for(const n in e)n&&!i(e[n])&&N(t,n,e[n]);return b(t,n),t}function I(t,e,...n){return R(document.createElement(t),e,n)}function T(t,...e){return I(t,null,...e)}function C(t,e,n,r){i(r)&&(r=!!e.startsWith("touch")&&{capture:!1,passive:!0}),t.addEventListener(e,n,r)}function S(t,e,n){t.removeEventListener(e,n)}const M=Symbol("$$");function v(t){const e=t.constructor;return e===RegExp||e===Date||e===Boolean}function P(t){return o(t)&&95!==t.charCodeAt(0)}function A(t){return o(t)?t:null===t?"null":i(t)?"undefined":t.toString()}function j(t){return o(t)?t.indexOf(".")>0?t.split("."):[t]:c(t)?t:[t]}function L(t,e,n){t.__parents||(t.__parents=[]),t.__parents.push({core:e,prop:n})}function U(t,e,n){if(!t.__parents)return;const r=t.__parents.findIndex(t=>t.core===e&&t.prop===n);r>=0&&t.__parents.splice(r,1)}const $=new Map;function H(t){const e=$.get(t);e&&(w(e.immediate),$.delete(t))}function F(t,e,n){const r=e.__handlers;r&&r.forEach(e=>{n?e(t):function(t,e){if($.has(t))return;const n=y(()=>{const e=$.get(t);try{t(e.propertyPath)}finally{$.delete(t)}});$.set(t,{immediate:n,propertyPath:e})}(e,t)});const s=e.__listeners;s&&s.forEach(e=>{F(t,e,n)})}function Z(t){const e=t.__listeners;e&&(e.forEach(t=>Z(t)),t.__listeners=null);const n=t.__handlers;n&&(n.forEach(H),t.__handlers=null),t.__parent=null}class k{constructor(t){this.__notifiable=!0,this.__parents=null,this.__listeners=null,this.__related=null,this.__setters=null,this.target=t,this.proxy=null,Object.defineProperty(t,M,{value:this,writable:!1,configurable:!0,enumerable:!1})}__watch(t,e,n){const r=(t=j(t)).indexOf("**");if(r>=0&&r!==t.length-1)throw new Error('wizard "**" must be last element in path.');const s=function t(e,n,r=0){const s=A(n[r]);e.__listeners||(e.__listeners=new Map);let o=e.__listeners.get(s);return o||(o={__parent:e,__property:s,__handlers:null,__listeners:null},e.__listeners.set(s,o)),n.length-1===r?o:t(o,n,r+1)}(this,t);s.__handlers||(s.__handlers=[]),s.__handlers.indexOf(e)<0&&s.__handlers.push(e),n&&n!==this&&n.__addRelated(this,t,e)}__unwatch(t,e,n){if(!t)return void Z(this);const r=function t(e,n,r=0){var s;const o=A(n[r]);if(!o)return null;const i=null===(s=e.__listeners)||void 0===s?void 0:s.get(o);return i?n.length-1===r?i:t(i,n,r+1):null}(this,j(t));if(!r)return;const s=r.__handlers;s&&(e?(H(e),l(s,e)):(s.forEach(H),s.length=0),function(t){if(t&&t.__handlers&&t.__handlers.length>0||t.__listeners&&t.__listeners.size>0)return null;const e=t.__parent,n=t.__property;t.__parent=null,e.__listeners.delete(n)}(r),n&&n!==this&&n.__rmRelated(this,t,e))}__notify(t,e=!1){if(!this.__notifiable)return;t=j(t),this.__listeners&&function t(e,n,r,s=0){const o=e.__listeners;if(!o)return;const i=A(n[s]);if(!i)return;let c=o.get(i);c&&(n.length-1===s?F(n,c,r):t(c,n,r,s+1)),c=o.get("*"),c&&(n.length-1===s?F(n,c,!0):t(c,n,r,s+1)),c=o.get("**"),c&&F(n,c,!0)}(this,t,e);const n=this.__parents;n&&n.forEach(n=>{const r=n.core;r?r.__notify([n.prop].concat(t),e):console.error("dev-warn-unexpected: parent of ViewModelCore has been destroied but not unlink.")})}__destroy(){this.__notifiable=!1,this.__parents=null,Z(this),this.proxy=null,this.__related&&(this.__related.forEach((t,e)=>{t.forEach(t=>{e.__unwatch(t.prop,t.handler)})}),this.__related=null);const t=this.target,e=this.__setters;e&&(e.forEach((e,n)=>{if(null===e)return;const r=t[n];s(r)&&M in r&&U(r[M],this,n)}),this.__setters=null),Object.getOwnPropertyNames(t).forEach(e=>{const n=t[e];s(n)&&M in n&&U(n[M],this,e)}),delete t[M],this.target=null}__addRelated(t,e,n){this.__related||(this.__related=new Map);let r=this.__related.get(t);r||this.__related.set(t,r=[]),r.push({prop:e,handler:n})}__rmRelated(t,e,n){if(!this.__related)return;const r=this.__related.get(t);if(!r)return;const s=c(e),o=r.findIndex(t=>n===t.handler&&(s?function(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}(e,t.prop):e===t.prop));o>=0&&r.splice(o,1)}}function V(t,e){t[M].__notify(e)}function B(t,e,n,r,o=!0){if(!P(e))return t[e]=n,!0;const c=t[e];if(c===n&&!i(n))return!0;let a=s(n)&&!v(n);if(a&&(a=M in n,o&&!a))throw new Error(`public property "${e.toString()}" of ViewModel must also be ViewModel`);return s(c)&&M in c&&U(c[M],t[M],e),r(t,e,n),a&&L(n[M],t[M],e),V(t,e),!0}function W(t,e,n){t[e]=n}function G(t,e,n){const r=function(t,e){let n=t[M].__setters;if(n||(t[M].__setters=n=new Map),n.has(e))return n.get(e);{let r,s=t.constructor,o=Object.getOwnPropertyDescriptor(s.prototype,e);if(o)return r=a(o.set)?o.set:null,n.set(e,r),r;for(s=Object.getPrototypeOf(s);s&&s.prototype;){if(o=Object.getOwnPropertyDescriptor(s.prototype,e),o)return r=a(o.set)?o.set:null,n.set(e,r),r;s=Object.getPrototypeOf(s)}return n.set(e,null),null}}(t,e);r?r.call(t[M].proxy,n):t[e]=n}function Y(t,e,n){return!(M in t)||B(t,e,n,W,!1)}function z(t,e,n){return M in t?B(t,e,n,G):(console.warn(`call setter "${e.toString()}" after destroied, resources such as setInterval maybe not released before destroy. component:`,t),!0)}function J(t){if(!s(t)||c(t))throw new Error("attrs() traget must be plain object.");return function(t){const e=new k(t);return e.__notifiable=!1,e.proxy=new Proxy(t,{set:Y})}(t)}const q=Symbol("listeners");class K{constructor(t){if(this[q]=null,t)for(const e in t){const n=t[e];this.__on(e,n.fn,n.opts)}}__notify(t,...e){if(!this[q])return;const n=this[q].get(t);n&&n.forEach(t=>{t.fn(...e)})}__on(t,e,n){this[q]||(this[q]=new Map);let r=this[q].get(t);if(r||this[q].set(t,r=[]),r.findIndex(t=>t.fn===e)>=0)console.warn("dulplicated messenger listener",t,e);else if(n&&n.once){const s=(...n)=>{e(...n),this.__off(t,e)};r.push({fn:s,opts:n})}else r.push({fn:e,opts:n})}__off(t,e){if(!this[q])return;if(!t)return void this[q].clear();const n=this[q].get(t);if(!n)return;if(!e)return void(n.length=0);const r=n.findIndex(t=>t.fn===e);n.splice(r,1)}}const Q=new class{constructor(){this.m=new Map,this.s=0}create(t){if(0===this.s)return;const e=I("style",{type:"text/css",id:t.dom});document.head.appendChild(e),e.styleSheet?e.styleSheet.cssText=t.css:e.textContent=t.css}add(t){if(!t)return;const e=this.m;let n=e.get(t.id);n?n.refs++:(n={id:t.id,css:t.css,dom:`__${t.id}__`,refs:1},e.set(t.id,n),this.create(n))}attch(){0===this.s?(this.s=1,function(){const t=I("span",{style:"position:absolute;left:-10000px;",class:"jg-hide"});document.body.appendChild(t);const e="none"===getComputedStyle(t).getPropertyValue("display");return document.body.removeChild(t),e}()||this.create({dom:`__jgsty_${u()}__`,css:".jg-hide{display:none!important}.jg-hide.jg-hide-enter,.jg-hide.jg-hide-leave{display:block!important}"}),this.m.forEach(t=>{this.create(t)})):console.warn("component styles already attached.")}remove(t){if(!t)return;const e=this.m.get(t.id);e&&(e.refs--,e.refs>0||(this.m.delete(e.id),0!==this.s&&document.head.removeChild(document.getElementById(e.dom))))}};function X(t){return new Function("__ctx",`return \`${t.replace(/`/g,"\\`").replace(/\$\{\s*([\w\d._$]+)\s*\}/g,(t,e)=>"${ __ctx."+e+" }")}\`;`)}const tt=new class extends K{constructor(){super(),this.__deps=null,this.__data=null,this.__cache=new Map,this.__key=null,this.__regLoc(window.JINGE_I18N_DATA)}get locale(){return this.__data.locale}__regDep(t,e){if(this.__deps||(this.__deps=[]),!this.__deps[t])throw new Error("conflict at "+t);this.__deps[t]=e}__regLoc(t){t&&!this.__cache.has(t.locale)&&(this.__cache.set(t.locale,t),this.__data||(this.__data=t))}switch(t,e="dist/locale.[locale].js"){if(this.__data.locale===t)return;const n=this.__cache.get(t);if(n)this.__data=n,this.__notify("i18n-change",this.locale);else{const n=u();this.__key=n,(a(e)?e(t):function(t,e){return window.fetch(e.replace("[locale]",t)).then(t=>t.text())}(t,e)).then(e=>{if(new Function("jinge",e)({i18n:this}),this.__key!==n||this.__data.locale===t)return;const r=this.__cache.get(t);this.__data=r,this.__notify("i18n-change",this.locale)})}}__t(t,e){const n=this.__data.dictionary;if(!(t in n))return"i18n_missing";let r=n[t];return o(r)&&(171===r.charCodeAt(0)?(r=n[r.substring(1)],o(r)&&(r=X(r))):r=X(r),n[t]=r),r(e)}__r(t,e){const n=this.__data.render;if(a(n)){if(!this.__deps)throw new Error("missing render depedents");this.__data.render=n(...this.__deps)}const r=n[e];if(!(t in r))throw new Error(`missing i18n ${e} for key: ${t}`);let s=r[t];return o(s)&&(r[t]=s=r[s]),s}watch(t,e){return this.__on("change",t),e&&t(this.locale),()=>{this.__off("change",t)}}};var et,nt;!function(t){t[t.INITIALIZE=0]="INITIALIZE",t[t.RENDERED=1]="RENDERED",t[t.WILLDESTROY=2]="WILLDESTROY",t[t.DESTROIED=3]="DESTROIED"}(et||(et={})),function(t){t[t.UNTOUCH=0]="UNTOUCH",t[t.TOUCHED=1]="TOUCHED",t[t.UNTOUCH_FREEZED=2]="UNTOUCH_FREEZED",t[t.TOUCHED_FREEZED=3]="TOUCHED_FREEZED"}(nt||(nt={}));const rt=Symbol("__");function st(t){return rt in t}function ot(t){if(!c(t)||0===t.length)throw new Error("Render results of component is empty");return t}class it extends K{constructor(t){if(!s(t)||!(M in t))throw new Error("Attributes passed to Component constructor must be ViewModel. See https://[todo]");const e=t[rt]||{};super(e.listeners),function(t){if(M in t)throw new Error("component has alreay been wrapped.");const e=new k(t);e.__notifiable=!1,e.proxy=new Proxy(t,{set:z})}(this),this[rt]={passedAttrs:t,context:e.context,contextState:nt.UNTOUCH,slots:e.slots,state:et.INITIALIZE,rootNodes:[],nonRootCompNodes:[],refs:null,relatedRefs:null,updateNextMap:null,compStylePid:null,deregDOM:null,deregI18N:null}}static create(t){return s(t=t||J({}))&&M in t||(t=J(t||{})),new this(t)[M].proxy}__i18nWatch(t,e){let n=this[rt].deregI18N;n||(this[rt].deregI18N=n=[]);const r=tt.watch(()=>{t.call(this)},e),s=()=>{r(),l(n,s)};return n.push(s),s}__domAddListener(t,e,n,r){let s=this[rt].deregDOM;s||(this[rt].deregDOM=s=[]);const o=function(t,e,n,r){return C(t,e,n,r),function(){S(t,e,n)}}(t,e,t=>{n.call(this,t)},r),i=()=>{o(),l(s,i)};return s.push(i),i}__domPassListeners(t,e){if(this[rt].state!==et.RENDERED)throw new Error("domPassListeners must be applied to component which is rendered.");const n=this[q];n&&0!==n.size&&(t&&!c(t)?(e=t,t=null):e||(e=this.__firstDOM),e.nodeType===Node.ELEMENT_NODE&&n.forEach((n,r)=>{t&&t.indexOf(r)>=0||n.forEach(t=>{const{opts:n,fn:s}=t;this.__domAddListener(e,r,t.opts&&(t.opts.stop||t.opts.prevent)?function(t){n.stop&&t.stopPropagation(),n.prevent&&t.preventDefault(),s.call(this,t)}:s,t.opts)})}))}get __transitionDOM(){const t=this[rt].rootNodes[0];return st(t)?t.__transitionDOM:t}get __firstDOM(){const t=this[rt].rootNodes[0];return st(t)?t.__firstDOM:t}get __lastDOM(){const t=this[rt].rootNodes,e=t[t.length-1];return st(e)?e.__lastDOM:e}__render(){const t=this.constructor;let e=t.template;if(!e&&this[rt].slots&&(e=this[rt].slots.default),!a(e))throw new Error(`Template of ${t.name} not found. Forget static getter "template"?`);return Q.add(t.style),e(this)}__renderToDOM(t,e=!0){if(this[rt].state!==et.INITIALIZE)throw new Error("component has already been rendered.");const n=ot(this.__render());var r,s,o;Q.attch(),e?(r=t.parentNode,s=n,o=t,r.replaceChild(O(s),o)):b(t,n),this.__handleAfterRender()}__destroy(t=!0){const e=this[rt];e.state>et.WILLDESTROY||(e.state=et.WILLDESTROY,this[M].__notifiable=!1,e.passedAttrs[M].__notifiable=!1,this.__notify("before-destroy"),this.__beforeDestroy(),this.__handleBeforeDestroy(t),super.__off(),Q.remove(this.constructor.style),e.passedAttrs[M].__destroy(),e.passedAttrs=null,this[M].__destroy(),e.updateNextMap&&(e.updateNextMap.forEach(t=>{w(t)}),e.updateNextMap=null),e.relatedRefs&&(e.relatedRefs.forEach(t=>{const e=t.origin[rt].refs;if(!e)return;const n=e.get(t.ref);c(n)?l(n,t.node||this):e.delete(t.ref)}),e.relatedRefs=null),e.deregDOM&&(e.deregDOM.forEach(t=>t()),e.deregDOM=null),e.deregI18N&&(e.deregI18N.forEach(t=>t()),e.deregI18N=null),e.state=et.DESTROIED,e.rootNodes=e.nonRootCompNodes=e.refs=e.slots=e.context=null)}__handleBeforeDestroy(t=!1){let e;this[rt].nonRootCompNodes.forEach(t=>{t.__destroy(!1)}),this[rt].rootNodes.forEach(n=>{st(n)?n.__destroy(t):t&&(e||(e=n.parentNode),e.removeChild(n))})}__handleAfterRender(){this[rt].passedAttrs[M].__notifiable=!0,this[M].__notifiable=!0,this[rt].rootNodes.forEach(t=>{st(t)&&t.__handleAfterRender()}),this[rt].nonRootCompNodes.forEach(t=>{st(t)&&t.__handleAfterRender()}),this[rt].state=et.RENDERED,this[rt].contextState=this[rt].contextState===nt.TOUCHED?nt.TOUCHED_FREEZED:nt.UNTOUCH_FREEZED,this.__afterRender(),this.__notify("after-render")}__updateIfNeed(t,e=!0){if(this[rt].state!==et.RENDERED)return;if(!1===t)return this.__update();if(a(t)||(t=this.__update),!e)return void t.call(this);let n=this[rt].updateNextMap;n||(n=this[rt].updateNextMap=new Map),n.has(t)||n.set(t,y(()=>{n.delete(t),t.call(this)}))}__update(t){}__setContext(t,e,n=!1){if(this[rt].contextState===nt.UNTOUCH_FREEZED||this[rt].contextState===nt.TOUCHED_FREEZED)throw new Error("Can't setContext after component has been rendered. Try put setContext code into constructor.");if(this[rt].contextState===nt.UNTOUCH&&(this[rt].context=Object.assign({},this[rt].context),this[rt].contextState=nt.TOUCHED),t in this[rt].context&&!n)throw new Error(`Contenxt with key: ${t.toString()} is exist. Pass third argument forceOverride=true to override it.`);this[rt].context[t]=e}__getContext(t){return this[rt].context?this[rt].context[t]:null}__setRef(t,e,n){let r=this[rt].refs;r||(this[rt].refs=r=new Map);let s=r.get(t);s?c(s)?s.push(e):(s=[s,e],r.set(t,s)):r.set(t,e);const o=st(e);if(!o&&this===n)return;let i=(o?e:n)[rt].relatedRefs;i||((o?e:n)[rt].relatedRefs=i=[]),i.push({origin:this,ref:t,node:o?null:e})}__getRef(t){return this[rt].state!==et.RENDERED&&console.warn(`Warning: call __getRef before component '${this.constructor.name}' rendered will get nothing. see https://[TODO]`),this[rt].refs?this[rt].refs.get(t):null}__addStylePid(t,e){if(!t&&!e)return;let n=this[rt].compStylePid;n||(n=this[rt].compStylePid=Object.create(null)),t&&Object.assign(n,t),e&&(n[e]="")}__afterRender(){}__beforeDestroy(){}}var ct;it[rt]=!0,function(t){t[t.ENTERING=1]="ENTERING",t[t.ENTERED=2]="ENTERED",t[t.LEAVING=3]="LEAVING",t[t.LEAVED=4]="LEAVED"}(ct||(ct={}));class at extends it{constructor(t){super(t);const e=this[M].proxy,n=()=>{e.name=t.name};n(),t[M].__watch("name",n)}get name(){return this._n}set name(t){this._n!==t&&(console.log("name updated"),this._n=t)}__afterRender(){console.log("base afterRender.")}}class lt extends at{constructor(t){super(t);this[M].proxy}static get template(){return function(t){const e=t;return[(()=>{const n=I("p",t[rt].compStylePid,"This is PageA: ",(()=>{const n=D(),r=()=>{x(n,e.name)};return r(),e[M].__watch(["name"],r,t[M]),n})());return t[rt].rootNodes.push(n),n})()]}}}class _t extends at{constructor(t){super(t);this[M].proxy}static get template(){return function(t){const e=t;return[(()=>{const n=I("p",t[rt].compStylePid,"This is PageB: ",(()=>{const n=D(),r=()=>{x(n,e.name)};return r(),e[M].__watch(["name"],r,t[M]),n})());return t[rt].rootNodes.push(n),n})()]}}__afterRender(){super.__afterRender(),console.log("PageB afterRender.")}}var ut,dt,ht,ft=function(t){const e=t;return[(()=>{const e=I("h2",t[rt].compStylePid,"Component Base");return t[rt].rootNodes.push(e),e})(),(()=>{const n=I("div",t[rt].compStylePid,...(()=>{const n=J({[rt]:{context:t[rt].context},name:null}),r=()=>{n.name=e.name};r(),e[M].__watch(["name"],r,t[M]);const s=lt.create(n);return t[rt].nonRootCompNodes.push(s),ot(s.__render())})(),...(()=>{const n=J({[rt]:{context:t[rt].context},name:null}),r=()=>{n.name=e.name};r(),e[M].__watch(["name"],r,t[M]);const s=_t.create(n);return t[rt].nonRootCompNodes.push(s),ot(s.__render())})(),T("p",(()=>{const t=T("button","Test");return C(t,"click",(function(...t){e.name="yuhang_"+e.inc++})),t})()));return t[rt].rootNodes.push(n),n})()]};ut=class extends it{static get template(){return ft}constructor(t){super(t);const e=this[M].proxy;e.name="jinge",e.inc=0}},dt=document.getElementById("root-app"),ut.create(ht).__renderToDOM(dt,dt!==document.body)}]);