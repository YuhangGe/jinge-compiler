{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:////Users/geyuhang/jinge/jinge-framework/util/type.js","webpack:////Users/geyuhang/jinge/jinge-framework/util/array.js","webpack:////Users/geyuhang/jinge/jinge-framework/util/const.js","webpack:////Users/geyuhang/jinge/jinge-framework/util/common.js","webpack:////Users/geyuhang/jinge/jinge-framework/util/setimm.js","webpack:////Users/geyuhang/jinge/jinge-framework/util/dom.js","webpack:////Users/geyuhang/jinge/jinge-framework/vm/core.js","webpack:////Users/geyuhang/jinge/jinge-framework/vm/proxy.js","webpack:////Users/geyuhang/jinge/jinge-framework/core/messenger.js","webpack:////Users/geyuhang/jinge/jinge-framework/core/style.js","webpack:////Users/geyuhang/jinge/jinge-framework/core/i18n.js","webpack:////Users/geyuhang/jinge/jinge-framework/core/component.js","webpack:////Users/geyuhang/jinge/jinge-framework/components/for.js","webpack:////Users/geyuhang/jinge/jinge-framework/components/if.js","webpack:////Users/geyuhang/jinge/jinge-framework/components/i18n.js","webpack:///./jinge/app.html","webpack:////Users/geyuhang/jinge/jinge-framework/core/bootstrap.js","webpack:///./jinge/index.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","typeOf","v","isObject","isString","isNumber","Number","isNaN","isFinite","isUndefined","isArray","Array","isFunction","instanceOf","Clazz","arrayIndexOf","array","item","indexOf","arrayRemove","idx","splice","STR_DEFAULT","STR_LENGTH","BEFORE_DESTROY_EVENT_NAME","AFTER_RENDER_EVENT_NAME","description","window","assertFail","msg","console","error","Error","assignObject","target","srcs","assign","getOwnPropertyNames","obj","enumFn","forEach","getOwnPropertySymbols","ss","createEmptyObject","uid","Date","now","toString","Math","floor","random","getOrCreateProperty","fn","getOrCreateMapProperty","Map","getOrCreateArrayProperty","tasksByHandle","registerImmediate","nextHandle","currentlyRunningATask","clearImmediateFallback","handle","delete","runIfPresent","setTimeout","callback","setImmediate","messagePrefix","addEventListener","event","source","data","str","search","position","startsWith","slice","length","postMessage","arguments","set","clearImmediate","getParent","$ele","parentNode","setAttribute","attrName","attrValue","attrN","removeAttribute","_createEl","$el","attrs","children","an","child","appendChild","createElement","tag","document","createFragment","$f","createDocumentFragment","createTextNode","text","prepareNewNode","newNode","removeChild","$parent","$child","ch","cc","addEvent","$element","eventName","handler","capture","removeEvent","removeEventListener","getCSPropertyValue","cst","prop","getPropertyValue","VM_ATTRS","VM_PROXY","VM_ON","VM_OFF","VM_NOTIFY","VM_NOTIFIABLE","VM_HOST","VM_RELATED_LISTENERS","PARENTS","LISTENERS_STAR","LISTENERS_DBSTAR","LISTENERS","LISTENERS_ID","LISTENERS_PARENT","LISTENERS_HANDLERS","VM_ADD_PARENT","VM_REMOVE_PARENT","VM_SHIFT_PARENT","VM_DESTROY","isInnerObj","clazz","constructor","RegExp","Boolean","isViewModel","isPublicProp","charCodeAt","propertyName","this","getPropN","loopClearNode","node","isRoot","listeners","sn","clear","handlers","_handleCancel","_handleTasks","loopHandle","propPath","has","imm","arg","_handleOnce","getProps","split","host","parent","push","pArr","findIndex","ps","delta","find","relatedComponent","loopCreateNode","vm","props","level","hostViewModel","rvl","hook","vmRelatedOn","loopGetNode","hs","size","id","delNode","isPropArray","it","arr1","arr2","arrayEqual","vmRelatedOff","loopNotify","vmAttrs","concat","unlinkHostProperties","vmRelatedClear","a","relatedListeners","arr","component","VM_SETTER_FN_MAP","notifyPropChanged","__propSetHandler","setFn","oldVal","newValIsVM","__objectPropSetFn","__componentPropSetFn","setterFn","map","desc","getOwnPropertyDescriptor","getPrototypeOf","getSetterFnIfPropIsSetter","objectPropSetHandler","arrayNotifyItems","idxStart","idxEnd","ObjectProxyHandler","ComponentProxyHandler","warn","PromiseProxyHandler","args","_arrayReverseSort","_arrayWrapSub","wrapEachItem","rtn","wrapProxy","loopWrapVM","_arrayShiftOrUnshiftProp","el","_argAssert","ArrayFns","delCount","shift","unshift","pop","fill","_arrayFill","reverse","sort","filter","si","ei","ArrayProxyHandler","oldLen","arrayLengthSetHandler","wrapProp","isArr","Proxy","then","plainObjectOrArray","k","wrapAttrs","attrsObj","onHelper","listenersMap","notifyKey","listener","getOrCreateValueOfMap","offHelper","ls","onceHelper","onceListener","NOTIFY","ON","OFF","CLEAR","templateListeners","notifyArgs","notifyHelper","eventListener","opts","once","CSTYLE_PID","CSTYLE_ADD","CSTYLE_DEL","CSTYLE_ATTACH","manager","sty","$style","type","dom","head","styleSheet","cssText","css","textContent","styleMap","info","refs","_c","$e","style","class","body","getComputedStyle","isHideCssExists","getElementById","I18N_GET_RENDER","I18N_GET_TEXT","I18N_GET_ATTR","I18N_LOCALE_CHANGE","I18N_RENDER_DEPS","LAST_FETCHING_KEY","CURRENT_DATA","CACHE","compile","Function","replace","defaultFetchFn","locale","fetch","res","getRenderOrAttr","depFns","renderOrAttr","i18n","super","JINGE_I18N_DATA","fetchFn","code","params","dict","dictionary","substring","immediate","RENDER","RENDER_TO_DOM","ARG_COMPONENTS","PASSED_ATTRS","CLONE","DESTROY","CONTEXT","CONTEXT_STATE","ROOT_NODES","NON_ROOT_COMPONENT_NODES","REF_NODES","SET_REF_NODE","REF_BELONGS","RELATED_DOM_REFS","GET_STATE_NAME","AFTER_RENDER","HANDLE_AFTER_RENDER","HANDLE_BEFORE_DESTROY","GET_FIRST_DOM","GET_LAST_DOM","GET_TRANSITION_DOM","BEFORE_DESTROY","GET_CONTEXT","SET_CONTEXT","GET_REF","UPDATE","UPDATE_IF_NEED","UPDATE_NEXT_MAP","STATE","STATE_INITIALIZE","STATE_RENDERED","STATE_WILLDESTROY","STATE_DESTROIED","STATE_NAMES","DOM_ON","DOM_PASS_LISTENERS","I18N_WATCH","DOM_LISTENER_DEREGISTERS","I18N_LISTENER_DEREGISTERS","wrapComponent","deregs","unwatcher","watch","deregister","lisDeregister","registerEvent","$event","ignoredEventNames","lis","nodeType","Node","ELEMENT_NODE","$evt","stop","stopPropagation","prevent","preventDefault","rns","isComponent","renderFn","template","$targetDOM","replaceMode","rr","renderResults","assertRenderResults","oldNode","replaceChild","removeDOM","sfm","unm","comp","_unref","refBelongs","destroyRelatedRefs","ctx","propN","destroyContext","releaseDeregisters","nextTick","ntMap","forceOverride","context","ref","elOrArr","nameOfDeregisters","Component","bootComponent","bootstrap"],"mappings":"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","file":"bundle.min.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/dist/\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n","export function typeOf(v) {\n  return typeof v;\n}\n\nexport function isObject(v) {\n  return v !== null && typeOf(v) === 'object';\n}\n\nexport function isString(v) {\n  return typeOf(v) === 'string';\n}\n\nexport function isNumber(v) {\n  return typeOf(v) === 'number' && !Number.isNaN(v) && Number.isFinite(v);\n}\n\nexport function isUndefined(v) {\n  return typeOf(v) === 'undefined';\n}\n\nexport function isArray(v) {\n  return Array.isArray(v);\n}\n\nexport function isBoolean(v) {\n  return typeof v === 'boolean' || instanceOf(v, Boolean);\n}\n\nexport function isFunction(v) {\n  return typeOf(v) === 'function';\n}\n\nexport function instanceOf(v, Clazz) {\n  return v instanceof Clazz;\n}\n\nexport function isDOMNode(ele) {\n  return instanceOf(ele, Node);\n}\n\nexport function isPromise(obj) {\n  return isObject(obj) && isFunction(obj.then);\n}\n","\nexport function arrayIndexOf(array, item) {\n  return array.indexOf(item);\n}\n\nexport function arrayRemove(array, item) {\n  const idx = arrayIndexOf(array, item);\n  if (idx < 0) return false;\n  array.splice(idx, 1);\n  return true;\n}\n\nexport function arrayPushIfNotExist(array, item) {\n  const idx = arrayIndexOf(array, item);\n  if (idx >= 0) return;\n  array.push(item);\n}\n\nexport function arrayFind(array, predicate) {\n  if (array.find) {\n    return array.find(predicate);\n  } else {\n    const i = arrayFindIndex(array, predicate);\n    return i >= 0 ? array[i] : null;\n  }\n}\n\nexport function arrayFindIndex(array, predicate) {\n  for (let i = 0; i < array.length; i++) {\n    if (predicate(array[i], i)) return i;\n  }\n  return -1;\n}\n\nexport function arrayEqual(arr1, arr2) {\n  if (arr1.length !== arr2.length) return false;\n  for (let i = 0; i < arr1.length; i++) {\n    if (arr1[i] !== arr2[i]) return false;\n  }\n  return true;\n}\n","export const STR_DEFAULT = 'default';\nexport const STR_JINGE = 'jinge';\nexport const STR_EMPTY = 'empty';\nexport const STR_LENGTH = 'length';\n\nexport const BEFORE_DESTROY_EVENT_NAME = 'jinge.before-destroy';\nexport const AFTER_RENDER_EVENT_NAME = 'jinge.after-render';\n\n/* eslint camelcase: \"off\" */\n/**\n * Constants below are prepared for code auto generated by compiler.\n */\nexport const HTML_ATTR_checked = 'checked';\nexport const HTML_ATTR_disabled = 'disabled';\nexport const HTML_ATTR_selected = 'selected';\nexport const HTML_ATTR_readOnly = 'readOnly';\nexport const HTML_ATTR_autofocus = 'autofocus';\nexport const HTML_ATTR_autocomplete = 'autocomplete';\nexport const HTML_ATTR_required = 'required';\nexport const HTML_ATTR_controls = 'controls';\nexport const HTML_ATTR_autoplay = 'autoplay';\nexport const HTML_ATTR_draggable = 'draggable';\nexport const HTML_ATTR_multiple = 'multiple';\nexport const HTML_ATTR_muted = 'muted';\nexport const HTML_ATTR_value = 'value';\n","\nexport function Symbol(description) {\n  return window.Symbol(description);\n}\n\nexport function assertFail(msg) {\n  msg && console.error(msg);\n  throw new Error('assert failed!');\n}\n\nexport function startsWith(str, search, position = 0) {\n  return str.startsWith(search, position);\n}\n\nexport function endsWith(str, search, endPosition) {\n  return str.endsWith(search, endPosition);\n}\n\nexport function defineProperty(...args) {\n  return Object.defineProperty(...args);\n}\n\nexport function assignObject(target, ...srcs) {\n  return Object.assign(target, ...srcs);\n}\n\nexport function obj2class(obj, prepend) {\n  const classes = Object.keys(obj).filter(k => obj[k]).join(' ').trim();\n  return prepend ? `${prepend}${classes ? ' ' + classes : ''}` : classes;\n}\n\nexport function obj2style(obj) {\n  return Object.keys(obj).map(k => {\n    return `${k}: ${obj[k]}`;\n  }).join(';').trim();\n}\n\nexport function defineProperties(...args) {\n  return Object.defineProperties(...args);\n}\n\n/**\n * @param {Object} obj\n * @param {Function} enumFn\n */\nexport function getOwnPropertyNames(obj, enumFn) {\n  const ns = Object.getOwnPropertyNames(obj);\n  if (enumFn) ns.forEach(enumFn);\n  return ns;\n}\n\n/**\n * @param {Object} obj\n * @param {Function} enumFn\n */\nexport function getOwnPropertySymbols(obj, enumFn) {\n  const ss = Object.getOwnPropertySymbols(obj);\n  if (enumFn) ss.forEach(enumFn);\n  return ss;\n}\n\nexport function isPropertyEnumerable(obj, key) {\n  return Object.prototype.propertyIsEnumerable.call(obj, key);\n}\n\nexport function createEmptyObject(o) {\n  return Object.create(o || null);\n}\n\nexport function uid() {\n  return Date.now().toString(32) + Math.floor(Math.random() * 0xffff).toString(32);\n}\n\nexport function mapObject(obj, fn) {\n  const newObj = {};\n  for (const k in obj) {\n    newObj[k] = fn(obj[k], k);\n  }\n  return newObj;\n}\n\nexport function getOrCreateProperty(obj, property, fn) {\n  let v = obj[property];\n  if (!v) {\n    v = obj[property] = fn();\n  }\n  return v;\n}\n\nexport function getOrCreateValueOfMap(map, key, fn) {\n  let v = map.get(key);\n  if (!v) {\n    v = fn();\n    map.set(key, v);\n  }\n  return v;\n}\n\nexport function getOrCreateMapProperty(obj, property) {\n  return getOrCreateProperty(obj, property, () => new Map());\n}\n\nexport function getOrCreateArrayValueOfMap(map, key) {\n  return getOrCreateValueOfMap(map, key, () => []);\n}\n\nexport function getOrCreateArrayProperty(obj, property) {\n  return getOrCreateProperty(obj, property, () => []);\n}\n","/**\n * setImmediate polyfill only for modern browsers\n * Copied from https://github.com/YuzuJS/setImmediate/blob/master/setImmediate.js\n * Simplified by Yuhang-Ge<abeyuhang@gmail.com>\n */\nimport {\n  isUndefined,\n  isFunction,\n  isString\n} from './type';\nimport {\n  assertFail,\n  startsWith,\n  uid\n} from './common';\n\nlet nextHandle = 1; // Spec says greater than zero\nlet tasksByHandle;\nlet currentlyRunningATask = false;\nlet registerImmediate;\n\nfunction setImmediateFallback(callback) {\n  if (!isFunction(callback) || arguments.length > 1) assertFail();\n  tasksByHandle.set(nextHandle, callback);\n  registerImmediate(nextHandle);\n  // console.log('siiii', callback);\n  return nextHandle++;\n}\n\nfunction clearImmediateFallback(handle) {\n  tasksByHandle.delete(handle);\n}\n\nfunction runIfPresent(handle) {\n  // From the spec: 'Wait until any invocations of this algorithm started before this one have completed.'\n  // So if we're currently running a task, we'll need to delay this invocation.\n  if (currentlyRunningATask) {\n    // Delay by doing a setTimeout. setImmediate was tried instead, but in Firefox 7 it generated a\n    // 'too much recursion' error.\n    return setTimeout(runIfPresent, 0, handle);\n  }\n  const callback = tasksByHandle.get(handle);\n  // console.log('stttt', handle, callback);\n\n  if (!callback) return;\n  currentlyRunningATask = true;\n  try {\n    callback();\n  } finally {\n    clearImmediateFallback(handle);\n    currentlyRunningATask = false;\n  }\n}\n\nif (isUndefined(window.setImmediate)) {\n  tasksByHandle = new Map();\n  const messagePrefix = 'setImmediate$' + uid() + '$';\n  window.addEventListener('message', event => {\n    if (event.source === window &&\n      isString(event.data) &&\n      startsWith(event.data, messagePrefix)) {\n      runIfPresent(Number(event.data.slice(messagePrefix.length)));\n    }\n  }, false);\n\n  registerImmediate = function(handle) {\n    window.postMessage(messagePrefix + handle, '*');\n  };\n}\n\nexport const setImmediate = window.setImmediate || setImmediateFallback;\nexport const clearImmediate = window.clearImmediate || clearImmediateFallback;\n","import {\n  isString,\n  isArray,\n  isUndefined,\n  isObject\n} from '../util';\n\nexport function getParent($ele) {\n  return $ele.parentNode;\n}\n\nexport function setText($element, text) {\n  if (isArray(text)) {\n    text = JSON.stringify(text);\n  }\n  $element.textContent = text;\n}\n\nexport function setAttribute($ele, attrName, attrValue) {\n  if (!attrName) return;\n  if (isObject(attrName)) {\n    for (const attrN in attrName) {\n      setAttribute($ele, attrN, attrName[attrN]);\n    }\n    return;\n  }\n  if (isUndefined(attrValue) || attrValue === null) {\n    removeAttribute($ele, attrName);\n  } else {\n    $ele.setAttribute(attrName, attrValue);\n  }\n}\n\nexport function removeAttribute($ele, attrName) {\n  if (!attrName) return;\n  if (isObject(attrName)) {\n    for (const attrN in attrName) {\n      removeAttribute($ele, attrN);\n    }\n    return;\n  }\n  return $ele.removeAttribute(attrName);\n}\n\nexport function setInputValue($inputOrTextarea, value) {\n  $inputOrTextarea.value = value;\n}\n\nfunction _createEl($el, attrs, children) {\n  if (attrs) {\n    for (const an in attrs) {\n      if (an && !isUndefined(attrs[an])) {\n        setAttribute($el, an, attrs[an]);\n      }\n    }\n  }\n  children.forEach(child => appendChild($el, child));\n  return $el;\n}\n\nexport function createElement(tag, attrs, ...children) {\n  return _createEl(\n    document.createElement(tag),\n    attrs, children\n  );\n}\n\nexport function createElementWithoutAttrs(tag, ...children) {\n  return createElement(tag, null, ...children);\n}\n\nexport function createSVGElement(tag, attrs, ...children) {\n  return _createEl(\n    document.createElementNS('http://www.w3.org/2000/svg', tag),\n    attrs, children\n  );\n}\n\nexport function createSVGElementWithoutAttrs(tag, ...children) {\n  return createSVGElement(tag, null, ...children);\n}\n\nexport function createFragment(children) {\n  const $f = document.createDocumentFragment();\n  if (children) children.forEach(c => appendChild($f, c));\n  return $f;\n}\n\nexport function createTextNode(text = '') {\n  return document.createTextNode(text);\n}\n\nexport function createElementWithChild(tag, attrs, child) {\n  const $e = createElement(tag, attrs);\n  appendChild($e, child);\n  return $e;\n}\n\nexport function createComment(data) {\n  return document.createComment(data);\n}\n\nfunction prepareNewNode(newNode) {\n  if (!isArray(newNode)) return newNode;\n  if (newNode.length === 0) return null;\n  else if (newNode.length === 1) return newNode[0];\n  else {\n    return createFragment(newNode);\n  }\n}\n\nexport function replaceChild($parent, newNode, oldNode) {\n  if (!(newNode = prepareNewNode(newNode))) {\n    return;\n  }\n  $parent.replaceChild(newNode, oldNode);\n}\n\nexport function insertBefore($parent, newNode, referenceNode) {\n  if (!(newNode = prepareNewNode(newNode))) {\n    return;\n  }\n  $parent.insertBefore(newNode, referenceNode);\n}\n\nexport function insertAfter($parent, newNode, referenceNode) {\n  if (!(newNode = prepareNewNode(newNode))) {\n    return;\n  }\n  const rn = referenceNode.nextSibling;\n  if (!rn) {\n    appendChild($parent, newNode);\n  } else {\n    insertBefore($parent, newNode, rn);\n  }\n}\n\nexport function removeChild($parent, $child) {\n  $parent.removeChild($child);\n}\n\nexport function appendChild($parent, ...children) {\n  children.forEach(ch => {\n    if (isArray(ch)) {\n      return ch.forEach(cc => appendChild($parent, cc));\n    }\n    if (isString(ch)) {\n      ch = createTextNode(ch);\n    }\n    $parent.appendChild(ch);\n  });\n}\n\nexport function hasClass($ele, className) {\n  return $ele.classList.contains(className);\n}\n\nexport function toggleClass($ele, ...args) {\n  return $ele.classList.toggle(...args);\n}\nexport function addClass($ele, className) {\n  return toggleClass($ele, className, true);\n}\n\nexport function removeClass($ele, className) {\n  return toggleClass($ele, className, false);\n}\n\nexport function replaceClass($ele, oldClass, newClass) {\n  return $ele.classList.replace(oldClass, newClass);\n}\n\nexport function addEvent($element, eventName, handler, capture = false) {\n  $element.addEventListener(eventName, handler, capture);\n}\n\nexport function removeEvent($element, eventName, handler) {\n  $element.removeEventListener(eventName, handler);\n}\n\n/**\n * Add event to DOM element, similar as addEventListener,\n * but return deregister function which will call removeEventListener.\n *\n * @param {HtmlElement} $element\n * @param {String} eventName\n * @param {Function} handler\n * @param {Boolean|Object} capture\n * @returns {Function} deregister function which will removeEventListener\n */\nexport function registerEvent($element, eventName, handler, capture) {\n  addEvent($element, eventName, handler, capture);\n  return function deregister() {\n    removeEvent($element, eventName, handler);\n  };\n}\n\nexport function getComputedStyle(el, pseudoElt) {\n  return window.getComputedStyle(el, pseudoElt);\n}\n\nexport function getCSPropertyValue(cst, prop) {\n  return cst.getPropertyValue(prop);\n}\n","import {\n  isObject,\n  isString,\n  isUndefined,\n  setImmediate,\n  clearImmediate,\n  Symbol,\n  getOrCreateMapProperty,\n  arrayRemove,\n  getOwnPropertyNames,\n  arrayPushIfNotExist,\n  getOrCreateArrayProperty,\n  isArray,\n  arrayEqual\n} from '../util';\n\nexport const VM_ATTRS = Symbol();\nexport const VM_DEBUG_NAME = Symbol();\nexport const VM_PROXY = Symbol();\nexport const VM_ON = Symbol();\nexport const VM_OFF = Symbol();\nexport const VM_NOTIFY = Symbol();\nexport const VM_NOTIFIABLE = Symbol();\nexport const VM_HOST = Symbol();\nexport const VM_RELATED_LISTENERS = Symbol();\n\nconst PARENTS = Symbol();\nconst LISTENERS_STAR = Symbol();\nconst LISTENERS_DBSTAR = Symbol();\nconst LISTENERS = Symbol();\nconst LISTENERS_ID = Symbol();\nconst LISTENERS_PARENT = Symbol();\nconst LISTENERS_HANDLERS = Symbol();\n\nexport const VM_ADD_PARENT = Symbol();\nexport const VM_REMOVE_PARENT = Symbol();\nexport const VM_SHIFT_PARENT = Symbol();\nexport const VM_DESTROY = Symbol();\n\nexport function isInnerObj(v) {\n  const clazz = v.constructor;\n  return clazz === RegExp || clazz === Date || clazz === Boolean;\n}\nexport function isViewModel(obj) {\n  return isObject(obj) && !isInnerObj(obj) && (VM_ATTRS in obj);\n}\n\nexport function isPublicProp(v) {\n  return isString(v) && v.charCodeAt(0) !== 95;\n}\n\nclass Node {\n  constructor(parentNode, propertyName) {\n    this[LISTENERS_PARENT] = parentNode;\n    this[LISTENERS_ID] = propertyName;\n    this[LISTENERS] = null;\n    this[LISTENERS_HANDLERS] = null;\n  }\n}\n\nfunction getPropN(v) {\n  if (v === LISTENERS_DBSTAR || v === LISTENERS_STAR || isString(v)) {\n    return v;\n  }\n  if (v === null) {\n    return 'null';\n  }\n  if (isUndefined(v)) {\n    return 'undefined';\n  }\n  return v.toString();\n}\n\nfunction loopCreateNode(vm, props, level = 0) {\n  const propertyName = getPropN(props[level]);\n  if (!propertyName) {\n    return null;\n  }\n  const listeners = getOrCreateMapProperty(vm, LISTENERS);\n  let node = listeners.get(propertyName);\n  if (!node) {\n    node = new Node(vm, propertyName);\n    listeners.set(propertyName, node);\n  }\n  if (props.length - 1 === level) {\n    return node;\n  } else {\n    return loopCreateNode(node, props, level + 1);\n  }\n}\n\nfunction loopGetNode(vm, props, level = 0) {\n  const propertyName = getPropN(props[level]);\n  if (!propertyName) {\n    return null;\n  }\n  const listeners = vm[LISTENERS];\n  const node = listeners.get(propertyName);\n  if (!node) {\n    return null;\n  }\n  if (props.length - 1 === level) {\n    return node;\n  } else {\n    return loopGetNode(node, props, level + 1);\n  }\n}\n\nfunction delNode(node) {\n  if ((node[LISTENERS_HANDLERS] && node[LISTENERS_HANDLERS].length > 0) ||\n    (node[LISTENERS] && node[LISTENERS].size > 0)\n  ) {\n    return;\n  }\n  /**\n   * if one node don't have any listener or child, delete it.\n   */\n  const parent = node[LISTENERS_PARENT];\n  const id = node[LISTENERS_ID];\n  node[LISTENERS_PARENT] = null; // unlink parent.\n  parent[LISTENERS].delete(id);\n  return parent;\n}\n\nfunction loopClearNode(node, isRoot = true) {\n  const listeners = node[LISTENERS];\n  if (listeners) {\n    // loop clear all child nodes\n    listeners.forEach(sn => loopClearNode(sn, false));\n    listeners.clear();\n    node[LISTENERS] = null;\n  }\n  if (isRoot) {\n    return;\n  }\n  // destroy all handlers\n  const handlers = node[LISTENERS_HANDLERS];\n  if (handlers) {\n    // clear handler waiting to execute\n    handlers.forEach(_handleCancel);\n    handlers.length = 0;\n    node[LISTENERS_HANDLERS] = null;\n  }\n  // unlink parent\n  node[LISTENERS_PARENT] = null;\n}\n\nconst _handleTasks = new Map();\nfunction _handleCancel(handler) {\n  const t = _handleTasks.get(handler);\n  if (t) {\n    clearImmediate(t.i);\n    _handleTasks.delete(handler);\n  }\n}\nfunction _handleOnce(node, handler, propPath) {\n  if (_handleTasks.has(handler)) {\n    return;\n  }\n  const imm = setImmediate(() => {\n    const arg = _handleTasks.get(handler);\n    try {\n      handler(arg.p);\n    } finally {\n      _handleTasks.delete(handler);\n    }\n  });\n  _handleTasks.set(handler, {\n    i: imm,\n    p: propPath\n  });\n}\n\nfunction loopHandle(propPath, node) {\n  const handlers = node[LISTENERS_HANDLERS];\n  handlers && handlers.forEach(handler => {\n    _handleOnce(node, handler, propPath);\n    // imms ? _handleOnce(node, handler, propPath) : handler(propPath);\n  });\n  const listeners = node[LISTENERS];\n  listeners && listeners.forEach(c => {\n    loopHandle(propPath, c);\n  });\n}\n\nfunction loopNotify(vm, props, level = 0) {\n  const listeners = vm[LISTENERS];\n  if (!listeners) {\n    return;\n  }\n  const propertyName = getPropN(props[level]);\n  if (!propertyName) {\n    return;\n  }\n  let node = listeners.get(propertyName);\n  if (node) {\n    if (props.length - 1 === level) {\n      // loopHandle(props, node, config[CFG_VM_DEBUG] ? null : imms);\n      loopHandle(props, node);\n    } else {\n      loopNotify(node, props, level + 1);\n    }\n  }\n  node = listeners.get(LISTENERS_STAR);\n  if (node) {\n    if (props.length - 1 === level) {\n      loopHandle(props, node, null);\n    } else {\n      loopNotify(node, props, level + 1);\n    }\n  }\n  node = listeners.get(LISTENERS_DBSTAR);\n  if (node) {\n    loopHandle(props, node, null);\n  }\n}\n\nfunction getProps(prop) {\n  return isString(prop) ? (\n    prop.indexOf('.') > 0 ? prop.split('.') : [prop]\n  ) : prop;\n}\n\nexport class ViewModelAttrs {\n  constructor(host) {\n    this[VM_HOST] = host;\n    this[VM_NOTIFIABLE] = true;\n    this[VM_PROXY] = null;\n    this[PARENTS] = null;\n    this[LISTENERS] = null;\n  }\n\n  [VM_ADD_PARENT](parent, prop) {\n    const pArr = getOrCreateArrayProperty(this, PARENTS);\n    pArr.push([parent, prop]);\n  }\n\n  [VM_REMOVE_PARENT](parent, prop) {\n    const pArr = this[PARENTS];\n    if (!pArr) return;\n    const idx = pArr.findIndex(ps => ps[0] === parent && ps[1] === prop);\n    if (idx >= 0) pArr.splice(idx, 1);\n  }\n\n  [VM_SHIFT_PARENT](parent, prop, delta) {\n    const pArr = this[PARENTS];\n    if (!pArr) return;\n    const ps = pArr.find(ps => ps[0] === parent && ps[1] === prop);\n    if (ps) {\n      ps[1] += delta;\n    }\n  }\n\n  [VM_ON](prop, handler, relatedComponent) {\n    const node = loopCreateNode(this, getProps(prop));\n    if (!node) {\n      return;\n    }\n    arrayPushIfNotExist(\n      getOrCreateArrayProperty(node, LISTENERS_HANDLERS),\n      handler\n    );\n    const host = this[VM_HOST];\n    if (!relatedComponent || !(VM_RELATED_LISTENERS in relatedComponent)) {\n      return;\n    }\n    // unwrap component out of wrapper proxy\n    relatedComponent = relatedComponent[VM_ATTRS][VM_HOST];\n    if (host === relatedComponent) {\n      return;\n    }\n    vmRelatedOn(relatedComponent, host, prop, handler);\n  }\n\n  [VM_OFF](prop, handler, relatedComponent) {\n    const node = loopGetNode(this, getProps(prop));\n    if (!node) {\n      return;\n    }\n\n    const hs = node[LISTENERS_HANDLERS];\n    if (!handler) { // remove all if second parameter is not provided\n      hs.forEach(_handleCancel);\n      hs.length = 0;\n    } else {\n      _handleCancel(handler);\n      arrayRemove(hs, handler);\n    }\n\n    delNode(node);\n\n    const host = this[VM_HOST];\n    if (!relatedComponent || !(VM_RELATED_LISTENERS in relatedComponent)) {\n      return;\n    }\n    // unwrap component out of wrapper proxy\n    relatedComponent = relatedComponent[VM_ATTRS][VM_HOST];\n    if (host === relatedComponent) {\n      return;\n    }\n    vmRelatedOff(relatedComponent, host, prop, handler);\n  }\n\n  [VM_NOTIFY](prop) {\n    if (!this[VM_NOTIFIABLE]) {\n      return;\n    }\n    const props = getProps(prop);\n    if (this[LISTENERS]) {\n      loopNotify(this, props);\n    }\n    const pArr = this[PARENTS];\n    pArr && pArr.forEach(ps => {\n      const vmAttrs = ps[0][VM_ATTRS];\n      if (!vmAttrs) {\n        console.error('dev-warn-unexpected: parent of ViewModelAttrs has been destroied but not unlink.');\n        return;\n      }\n      vmAttrs[VM_NOTIFY](\n        [ps[1]].concat(props)\n      );\n    });\n  }\n\n  [VM_DESTROY](unlinkHostProperties = true) {\n    // mark as non-notifiable\n    this[VM_NOTIFIABLE] = false;\n    // clear assignment parents\n    const pArr = this[PARENTS];\n    pArr && (pArr.length = 0);\n    this[PARENTS] = null;\n    // clear listeners\n    loopClearNode(this);\n    // unlink host object wrapper proxy\n    this[VM_PROXY] = null;\n\n    const host = this[VM_HOST];\n\n    // destroy related listeners\n    if (VM_RELATED_LISTENERS in host) {\n      vmRelatedClear(host[VM_RELATED_LISTENERS]);\n      host[VM_RELATED_LISTENERS] = null;\n    }\n    // unlink vm host\n    this[VM_HOST] = null;\n    /*\n     * by default, we will reset VM_HOST object's all public properties to null\n     *   to remove VM_HOST object from old property value's VM_PARENTS\n     *\n     * 默认情况下（即 === true），会将 VM_HOST 对象的所有（不以 '_' 打头的）公共属性重置为 null，这个赋值会触发 ./proxy.js 中的逻辑，\n     *   将该对\b象从属性原来的值的 VM_PARENTS 中移除，从而达到解除 ViewModel 之间的关联，回收资源和防止潜在 bug 的目的。\n     *\n     * 当 VM 对象是某个类的实例时，由于类可以通过 setter 函数定义公共属性，而这一类的公共属性不能\n     *   通过 getOwnPropertyNames 来遍历。因此这种情况，需要主动传递 unlinkHostProperties = false\n     *   来禁用默认的重置属性逻辑，然后自己处理相关的重置逻辑。比如 Component 组件。\n     */\n    unlinkHostProperties && getOwnPropertyNames(host, prop => {\n      if (prop.charCodeAt(0) === 95) {\n        return;\n      }\n      const v = host[prop];\n      if (!isObject(v)) {\n        return;\n      }\n      const a = v[VM_ATTRS];\n      a && a[VM_REMOVE_PARENT](host, prop);\n      host[prop] = null;\n    });\n  }\n}\n\nfunction vmRelatedOn(relatedComponent, hostViewModel, prop, handler) {\n  const rvl = getOrCreateMapProperty(relatedComponent, VM_RELATED_LISTENERS);\n  let hook = rvl.get(hostViewModel);\n  if (!hook) {\n    hook = [];\n    rvl.set(hostViewModel, hook);\n  }\n  hook.push([prop, handler]);\n}\n\nfunction vmRelatedOff(relatedComponent, hostViewModel, prop, handler) {\n  const rvl = relatedComponent[VM_RELATED_LISTENERS];\n  if (!rvl) return;\n  const hook = rvl.get(hostViewModel);\n  if (!hook) return;\n  const isPropArray = isArray(prop);\n  const i = hook.findIndex(it => {\n    return handler === it[1] &&\n      (isPropArray\n        ? arrayEqual(prop, it[0])\n        : prop === it[0]\n      );\n  });\n  if (i >= 0) {\n    hook.splice(i, 1);\n  }\n}\n\nexport function vmRelatedClear(relatedListeners) {\n  if (!relatedListeners) return;\n  relatedListeners.forEach((arr, component) => {\n    arr.forEach(hook => {\n      component[VM_ATTRS][VM_OFF](hook[0], hook[1]);\n    });\n    arr.length = 0;\n  });\n  relatedListeners.clear();\n}\n\nexport class RelatedListenersStore {\n  constructor() {\n    /**\n     * VM_ON/VM_OFF 绑定属性监听接受三个参数，其中第三个参数为关联组件。\n     *   当关联组件被销毁时，可以同时销毁保存在其 VM_RELATED_LISTENERS 中的父亲 ViewModel 的\n     *   属性监听函数（参看 ../core/component.js 里 VM_RELATED_LISTENERS 的注释）。\n     *\n     * 在多语言国际化方案中，当 attrs 渲染函数代码被提取到独立的多语言资源文件后，除了关联组件被销毁时需要销毁父 ViewModel 的属性监听，\n     *   当 locale 发生变化时，这些监听函数也要销毁。为了实现这个目标，采用了一个取巧的思路，传递一个模拟的关联组件，\n     *   即 RelatedListenersStore 来存储 VM_RELATED_LISTENERS。\n     *\n     * 以下的 VM_RELATED_LISTENERS 和 VM_ATTRS 的定义就是为了实现该模拟，使得\n     *   VM_ON/VM_OFF 函数可以正常执行关联组件的逻辑。\n     */\n    this[VM_RELATED_LISTENERS] = null;\n    this[VM_ATTRS] = {\n      [VM_HOST]: this\n    };\n  }\n\n  // destroy\n  d() {\n    vmRelatedClear(this[VM_RELATED_LISTENERS]);\n    this[VM_RELATED_LISTENERS] = null;\n  }\n}\n\nexport function vmWatch(vm, prop, handler) {\n  const vmAttrs = vm[VM_ATTRS];\n  if (!vmAttrs) {\n    throw new Error('vmWatch require ViewModel object');\n  }\n  let dbStarIdx = -1;\n  const props = getProps(prop).map((p, i) => {\n    if (p === '**') {\n      dbStarIdx = i;\n      return LISTENERS_DBSTAR;\n    }\n    return p === '*' ? LISTENERS_STAR : p;\n  });\n  if (dbStarIdx >= 0 && dbStarIdx !== props.length - 1) {\n    /**\n     * 'a.b.**' is good.\n     * 'a.b.**.c' is bad.\n     */\n    throw new Error('wizard \"**\" must be last element in path.');\n  }\n  vmAttrs[VM_ON](props, handler);\n}\n\nexport function vmUnwatch(vm, prop, handler) {\n  const vmAttrs = vm[VM_ATTRS];\n  if (!vmAttrs[VM_NOTIFIABLE]) {\n    return;\n  }\n  if (!prop) {\n    loopClearNode(vmAttrs);\n  } else {\n    vmAttrs[VM_OFF](prop, handler);\n  }\n}\n","import {\n  Symbol,\n  isNumber,\n  isArray,\n  isObject,\n  STR_LENGTH,\n  isFunction,\n  isPromise,\n  isUndefined,\n  getOrCreateMapProperty,\n  assertFail\n} from '../util';\nimport {\n  isInnerObj,\n  isPublicProp,\n  ViewModelAttrs,\n  VM_ATTRS,\n  VM_PROXY,\n  VM_NOTIFY,\n  VM_NOTIFIABLE,\n  isViewModel,\n  VM_ADD_PARENT,\n  VM_REMOVE_PARENT,\n  VM_SHIFT_PARENT\n} from './core';\n\nexport const VM_SETTER_FN_MAP = Symbol();\n\n/**\n * check if property named \"prop\" is setter of instance \"obj\",\n * if it's setter, return setter function, otherwise return null.\n * @param {Object} obj\n * @param {String} prop\n *\n * 检测名称为 \"prop\" 的属性是否是 setter，如果是，返回该 setter 函数，\n * 否则，返回 null。\n * 由于 obj 可能是有继承关系的类的实例，因此需要向上检测继承的类的 prototype。\n */\nfunction getSetterFnIfPropIsSetter(obj, prop) {\n  const map = getOrCreateMapProperty(obj, VM_SETTER_FN_MAP);\n  if (!map.has(prop)) {\n    let clazz = obj.constructor;\n    let desc = Object.getOwnPropertyDescriptor(clazz.prototype, prop);\n    let fn;\n    if (desc) {\n      fn = isFunction(desc.set) ? desc.set : null;\n      map.set(prop, fn);\n      return fn;\n    }\n    // lookup to check parent classes\n    clazz = Object.getPrototypeOf(clazz);\n    while (clazz && clazz.prototype) {\n      desc = Object.getOwnPropertyDescriptor(clazz.prototype, prop);\n      if (desc) {\n        fn = isFunction(desc.set) ? desc.set : null;\n        map.set(prop, fn);\n        return fn;\n      }\n      clazz = Object.getPrototypeOf(clazz);\n    }\n    map.set(prop, null);\n    return null;\n  } else {\n    return map.get(prop);\n  }\n}\n\nfunction notifyPropChanged(vm, prop) {\n  vm[VM_ATTRS][VM_NOTIFY](prop);\n}\n\nfunction __propSetHandler(target, prop, value, setFn) {\n  if (!isPublicProp(prop)) {\n    target[prop] = value;\n    return true;\n  }\n  const oldVal = target[prop];\n  if (oldVal === value && !isUndefined(value)) {\n    return true;\n  }\n  const newValIsVM = isObject(value) && !isInnerObj(value);\n  if (newValIsVM && !(VM_ATTRS in value)) {\n    throw new Error(`public property \"${prop}\" of ViewModel must also be ViewModel`);\n  }\n  // console.log(`'${prop}' changed from ${store[prop]} to ${value}`);\n  if (isObject(oldVal)) {\n    const a = oldVal[VM_ATTRS];\n    a && a[VM_REMOVE_PARENT](target, prop);\n  }\n  setFn(target, prop, value);\n  if (newValIsVM) {\n    value[VM_ATTRS][VM_ADD_PARENT](target, prop);\n  }\n  notifyPropChanged(target, prop);\n  return true;\n}\n\nfunction __objectPropSetFn(target, prop, value) {\n  target[prop] = value;\n}\n\nfunction __componentPropSetFn(target, prop, value) {\n  /**\n   * we must ensure `this` in setter function to be `Proxy`\n   *\n   * 首先判断当前赋值的变量名，是否对应了一个 setter 函数，\n   * 如果是 setter 函数，则应该显式地调用，\n   *   并将 `this` 设置为该 target 的包装 Proxy，\n   *   这样才能保正 setter 函数中其它赋值语句能触发 notify。\n   * 如果不是 setter 函数，则简单地使用 target\\[prop\\] 赋值即可。\n   */\n  const setterFn = getSetterFnIfPropIsSetter(target, prop);\n  if (setterFn) {\n    setterFn.call(target[VM_ATTRS][VM_PROXY], value);\n  } else {\n    target[prop] = value;\n  }\n}\n\nfunction objectPropSetHandler(target, prop, value) {\n  if (!target[VM_ATTRS]) {\n    // ViewModel has been destroied.\n    return true;\n  }\n  return __propSetHandler(target, prop, value, __objectPropSetFn);\n}\n\nfunction componentPropSetHandler(target, prop, value) {\n  if (!target[VM_ATTRS]) {\n    console.warn(`call setter \"${prop.toString()}\" after destroied, resources such as setInterval maybe not released before destroy. component:`, target);\n    return true;\n  }\n  return __propSetHandler(target, prop, value, __componentPropSetFn);\n}\n\nfunction arrayPropSetHandler(target, prop, value) {\n  if (prop === STR_LENGTH) {\n    return arrayLengthSetHandler(target, value);\n  }\n  return objectPropSetHandler(target, prop, value);\n}\n\nfunction arrayNotifyItems(target, idxStart, idxEnd) {\n  let i = idxStart;\n  if (idxStart > idxEnd) {\n    i = idxEnd;\n    idxEnd = idxStart;\n  }\n  for (; i < idxEnd; i++) {\n    // console.log('npc', i);\n    notifyPropChanged(target, i);\n  }\n}\n\nfunction arrayLengthSetHandler(target, value) {\n  if (!isNumber(value)) throw new Error('bad argument. array length must be validate number.');\n  const oldLen = target.length;\n  if (oldLen > value) {\n    for (let i = value; i < oldLen; i++) {\n      const v = target[i];\n      isViewModel(v) && v[VM_ATTRS][VM_REMOVE_PARENT](target, i);\n    }\n  }\n  target.length = value;\n  // console.log('set .length from', oldLen, 'to', value);\n  if (oldLen !== value) {\n    notifyPropChanged(target, STR_LENGTH);\n    arrayNotifyItems(target, oldLen, value);\n  }\n  return true;\n}\n\nexport const ObjectProxyHandler = {\n  set: objectPropSetHandler\n};\n\nexport const ComponentProxyHandler = {\n  set: componentPropSetHandler\n};\n\nexport const PromiseProxyHandler = {\n  get(target, prop) {\n    if (prop === 'then' || prop === 'catch') {\n      const v = target[prop];\n      return function(...args) {\n        return v.call(target, ...args);\n      };\n    } else {\n      return target[prop];\n    }\n  },\n  set: objectPropSetHandler\n};\n\nfunction _arrayFill(target, v) {\n  target.forEach((it, i) => {\n    if (it === v && !isUndefined(it)) {\n      return;\n    }\n    if (isViewModel(it)) {\n      it[VM_ATTRS][VM_REMOVE_PARENT](target, i);\n    }\n    target[i] = v;\n    if (isViewModel(it)) {\n      it[VM_ATTRS][VM_ADD_PARENT](target, i);\n    }\n    notifyPropChanged(target, i);\n  });\n  return target[VM_ATTRS][VM_PROXY];\n}\n\nfunction _arrayReverseSort(target, fn, arg) {\n  target.forEach((it, i) => {\n    if (isViewModel(it)) {\n      it[VM_ATTRS][VM_ADD_PARENT](target, i);\n    }\n  });\n  target[fn](arg);\n  target.forEach((it, i) => {\n    if (isViewModel(it)) {\n      it[VM_ATTRS][VM_REMOVE_PARENT](parent, i);\n    }\n  });\n  arrayNotifyItems(target, 0, target.length);\n  // return wrapper proxy to ensure `arr.reverse() === arr`\n  return target[VM_ATTRS][VM_PROXY];\n}\n\nfunction _arrayWrapSub(arr, wrapEachItem = false) {\n  const rtn = wrapProxy(arr, true);\n  // handleVMDebug(arr);\n  arr.forEach((it, i) => {\n    if (isViewModel(it)) {\n      it[VM_ATTRS][VM_ADD_PARENT](arr, i);\n    } else if (wrapEachItem) {\n      arr[i] = loopWrapVM(it);\n    }\n  });\n  return rtn;\n}\n\nfunction _arrayShiftOrUnshiftProp(arr, delta) {\n  arr.forEach((el, i) => {\n    if (!isViewModel(el)) return;\n    el[VM_ATTRS][VM_SHIFT_PARENT](arr, i, delta);\n  });\n}\n\nfunction _argAssert(arg, fn) {\n  if (isObject(arg)) {\n    if (!(VM_ATTRS in arg)) {\n      throw new Error(`argument passed to Array.${fn} must be ViewModel if the array is ViewModel`);\n    } else {\n      return true;\n    }\n  } else {\n    return false;\n  }\n}\n\nconst ArrayFns = {\n  splice(target, idx, delCount, ...args) {\n    if (idx < 0) idx = 0;\n    args.forEach((arg, i) => {\n      if (_argAssert(arg, 'splice')) {\n        arg[VM_ATTRS][VM_ADD_PARENT](target, idx + i);\n      }\n    });\n    for (let i = 0; i < delCount; i++) {\n      if (idx + i >= target.length) break;\n      const el = target[idx + i];\n      if (isViewModel(el)) {\n        el[VM_ATTRS][VM_REMOVE_PARENT](target, idx + i);\n      }\n    }\n    const delta = args.length - delCount;\n    if (delta !== 0) {\n      for (let i = idx + delCount; i < target.length; i++) {\n        const el = target[i];\n        if (!isViewModel(el)) continue;\n        el[VM_ATTRS][VM_SHIFT_PARENT](target, i, delta);\n      }\n    }\n    const rtn = _arrayWrapSub(target.splice(idx, delCount, ...args));\n    if (delta !== 0) {\n      notifyPropChanged(target, STR_LENGTH);\n      for (let i = idx; i < target.length; i++) {\n        notifyPropChanged(target, i);\n      }\n    }\n    return rtn;\n  },\n  shift(target) {\n    if (target.length === 0) return target.shift();\n    _arrayShiftOrUnshiftProp(target, -1);\n    const el = target.shift();\n    if (isViewModel(el)) {\n      el[VM_ATTRS][VM_REMOVE_PARENT](target, -1);\n    }\n    notifyPropChanged(target, STR_LENGTH);\n    for (let i = 0; i < target.length + 1; i++) {\n      notifyPropChanged(target, i);\n    }\n    return el;\n  },\n  unshift(target, ...args) {\n    if (args.length === 0) return target.unshift();\n    args.forEach((arg, i) => {\n      if (_argAssert(arg, 'unshift')) {\n        arg[VM_ATTRS][VM_ADD_PARENT](target, i);\n      }\n    });\n    _arrayShiftOrUnshiftProp(target, args.length);\n    const rtn = target.unshift(...args);\n    notifyPropChanged(target, STR_LENGTH);\n    for (let i = 0; i < target.length; i++) {\n      notifyPropChanged(target, i);\n    }\n    return rtn;\n  },\n  pop(target) {\n    if (target.length === 0) {\n      return target.pop();\n    }\n    const el = target.pop();\n    if (isViewModel(el)) {\n      el[VM_ATTRS][VM_REMOVE_PARENT](target, target.length);\n    }\n    notifyPropChanged(target, STR_LENGTH);\n    notifyPropChanged(target, target.length);\n    return el;\n  },\n  push(target, ...args) {\n    if (args.length === 0) return target.push();\n    args.forEach((arg, i) => {\n      if (_argAssert(arg, 'push')) {\n        arg[VM_ATTRS][VM_ADD_PARENT](target, target.length + i);\n      }\n    });\n    const rtn = target.push(...args);\n    notifyPropChanged(target, STR_LENGTH);\n    for (let i = target.length - 1 - args.length; i < target.length; i++) {\n      notifyPropChanged(target, i);\n    }\n    return rtn;\n  },\n  fill(target, v) {\n    _argAssert(v, 'fill');\n    return _arrayFill(target, v);\n  },\n  reverse(target) {\n    return _arrayReverseSort(target, 'reverse');\n  },\n  sort(target, fn) {\n    return _arrayReverseSort(target, 'sort', fn);\n  },\n  concat(target, arr) {\n    _argAssert(arr, 'concat');\n    return _arrayWrapSub(target.concat(arr));\n  },\n  filter(target, fn) {\n    return _arrayWrapSub(target.filter(fn));\n  },\n  slice(target, si, ei) {\n    return _arrayWrapSub(target.slice(si, ei));\n  },\n  map(target, fn) {\n    return _arrayWrapSub(target.map(fn), true);\n  }\n};\n\nexport const ArrayProxyHandler = {\n  get(target, prop) {\n    if (prop in ArrayFns) {\n      const fn = ArrayFns[prop];\n      return function(...args) {\n        return fn(target, ...args);\n      };\n    } else {\n      return target[prop];\n    }\n  },\n  set: arrayPropSetHandler\n};\n\nfunction wrapProp(vm, prop) {\n  const v = vm[prop];\n  if (!isObject(v) || isInnerObj(v)) {\n    return;\n  }\n  if (VM_ATTRS in v) {\n    v[VM_ATTRS][VM_ADD_PARENT](vm, prop);\n    return;\n  }\n  vm[prop] = loopWrapVM(v);\n  v[VM_ATTRS][VM_ADD_PARENT](vm, prop);\n}\n\nfunction wrapProxy(vm, isArr) {\n  const vmAttrs = new ViewModelAttrs(vm);\n  vm[VM_ATTRS] = vmAttrs;\n  const p = new Proxy(vm, isArr ? ArrayProxyHandler : (\n    isPromise(vm) ? PromiseProxyHandler : ObjectProxyHandler\n  ));\n  vmAttrs[VM_PROXY] = p;\n  return p;\n}\n\nfunction loopWrapVM(plainObjectOrArray) {\n  if (isObject(plainObjectOrArray)) {\n    // directly return if alreay is ViewModel or inner object(Date/RegExp/Boolean).\n    if (isInnerObj(plainObjectOrArray) || (VM_ATTRS in plainObjectOrArray)) {\n      return plainObjectOrArray;\n    }\n\n    if (isArray(plainObjectOrArray)) {\n      for (let i = 0; i < plainObjectOrArray.length; i++) {\n        wrapProp(plainObjectOrArray, i);\n      }\n      return wrapProxy(plainObjectOrArray, true);\n    } else {\n      for (const k in plainObjectOrArray) {\n        if (isPublicProp(k)) {\n          wrapProp(plainObjectOrArray, k);\n        }\n      }\n      return wrapProxy(plainObjectOrArray, false);\n    }\n  } else {\n    return plainObjectOrArray;\n  }\n}\n\nexport function wrapViewModel(plainObjectOrArray) {\n  const vm = loopWrapVM(plainObjectOrArray);\n  // if (vm !== plainObjectOrArray) {\n  //   handleVMDebug(plainObjectOrArray);\n  // }\n  return vm;\n}\n\n// alias for convenient\nexport const VM = wrapViewModel;\n\n// function handleVMDebug(vm) {\n//   if (!config[CFG_VM_DEBUG]) {\n//     return;\n//   }\n//   let _di = window._VM_DEBUG;\n//   if (!_di) {\n//     _di = window._VM_DEBUG = {\n//       id: 0, vms: []\n//     };\n//   }\n//   vm[VM_DEBUG_ID] = _di.id++;\n//   // if (isComponent(vm) && !(VM_DEBUG_NAME in vm)) {\n//   //   vm[VM_DEBUG_NAME] = `<${vm.constructor.name}>`;\n//   // }\n//   _di.vms.push(vm);\n// }\n\nexport function wrapComponent(component) {\n  if (component[VM_ATTRS]) {\n    throw new Error('alreay wraped.');\n  }\n  // handleVMDebug(component);\n  const vmAttrs = new ViewModelAttrs(component);\n  // 初始化时 Component 默认的 VM_NOTIFIABLE 为 false，\n  // 待 RENDER 结束后才修改为 true，用于避免无谓的消息通知。\n  vmAttrs[VM_NOTIFIABLE] = false;\n  component[VM_ATTRS] = vmAttrs;\n  const p = new Proxy(component, ComponentProxyHandler);\n  vmAttrs[VM_PROXY] = p;\n  return p;\n}\n\nexport function wrapAttrs(attrsObj) {\n  if (!isObject(attrsObj)) {\n    assertFail();\n  }\n  for (const k in attrsObj) {\n    if (isPublicProp(k)) {\n      const v = attrsObj[k];\n      if (isObject(v) && !isInnerObj(v) && !(VM_ATTRS in v)) {\n        throw new Error(`value passed to attribute \"${k}\" must be ViewModel.`);\n      }\n    }\n  }\n  const attrs = wrapProxy(attrsObj, false);\n  // 初始化时 Component 默认的 VM_NOTIFIABLE 为 false，\n  // 待 RENDER 结束后才修改为 true，用于避免无谓的消息通知。\n  attrs[VM_ATTRS][VM_NOTIFIABLE] = false;\n  return attrs;\n}\n","import {\n  Symbol,\n  getOrCreateArrayValueOfMap,\n  getOrCreateMapProperty\n} from '../util';\n\nexport const LISTENERS = Symbol();\n\nexport function notifyHelper(listenersMap, notifyKey, ...notifyArgs) {\n  if (!listenersMap) return;\n  const listeners = listenersMap.get(notifyKey);\n  if (!listeners) return;\n  listeners.forEach(handler => handler(...notifyArgs));\n}\n\nexport function onHelper(listenersMap, notifyKey, listener) {\n  const listeners = getOrCreateArrayValueOfMap(listenersMap, notifyKey);\n  if (listeners.indexOf(listener) < 0) {\n    listeners.push(listener);\n  }\n}\n\nexport function offHelper(listenersMap, notifyKey, listener) {\n  if (!listenersMap) return;\n  if (!notifyKey) {\n    listenersMap.forEach(ls => {\n      ls.length = 0;\n    });\n    listenersMap.clear();\n    return;\n  }\n  const listeners = listenersMap.get(notifyKey);\n  if (!listeners) return;\n  if (!listener) {\n    listeners.length = 0; // clear all if listener is not provided\n    return;\n  }\n  const idx = listeners.indexOf(listener);\n  if (idx < 0) return;\n  listeners.splice(idx, 1);\n}\n\nexport function clearHelper(listenersMap, notifyKey) {\n  if (!listenersMap) return;\n  if (!notifyKey) {\n    listenersMap.clear();\n  } else {\n    listenersMap.delete(notifyKey);\n  }\n}\n\nexport function onceHelper(listenersMap, notifyKey, listener) {\n  function onceListener(...args) {\n    listener(...args);\n    offHelper(listenersMap, notifyKey, onceListener);\n  }\n  onHelper(listenersMap, notifyKey, onceListener);\n}\n\nexport const NOTIFY = Symbol();\nexport const ON = Symbol();\nexport const OFF = Symbol();\nexport const CLEAR = Symbol();\n\nexport class Messenger {\n  /**\n   * Listeners compiled from template.\n   * @param {Object} templateListeners\n   */\n  constructor(templateListeners) {\n    this[LISTENERS] = null;\n    if (templateListeners) {\n      for (const eventName in templateListeners) {\n        this[ON](eventName, ...templateListeners[eventName]);\n      }\n    }\n  }\n\n  [NOTIFY](eventName, ...args) {\n    notifyHelper(this[LISTENERS], eventName, ...args);\n  }\n\n  [ON](eventName, eventListener, opts) {\n    const listeners = getOrCreateMapProperty(this, LISTENERS);\n    if (opts) {\n      eventListener.tag = opts;\n    }\n    if (opts && opts.once) {\n      onceHelper(listeners, eventName, eventListener);\n    } else {\n      onHelper(listeners, eventName, eventListener);\n    }\n  }\n\n  [OFF](eventName, eventListener) {\n    offHelper(this[LISTENERS], eventName, eventListener);\n  }\n\n  [CLEAR](eventName) {\n    clearHelper(this[LISTENERS], eventName);\n  }\n}\n\n/**\n * pass all listeners on srcMessenger to dstMessenger\n * @param {Messenger} srcMessenger\n * @param {Messenger} dstMessenger\n */\nexport function passListeners(srcMessenger, dstMessenger) {\n  if (!(LISTENERS in srcMessenger) || !(LISTENERS in dstMessenger)) {\n    // src or dst is not instance of Messenger\n    return;\n  }\n  const srcLis = srcMessenger[LISTENERS];\n  if (!srcLis) return;\n  srcLis.forEach((lis, key) => {\n    const dstLis = getOrCreateMapProperty(dstMessenger, LISTENERS);\n    lis.forEach(listener => {\n      const tag = listener.tag;\n      if (tag && tag.once) {\n        onceHelper(dstLis, key, listener);\n      } else {\n        onHelper(dstLis, key, listener);\n      }\n    });\n  });\n}\n","import {\n  Symbol,\n  uid,\n  createEmptyObject,\n  assignObject,\n  createElement,\n  appendChild,\n  getCSPropertyValue\n} from '../util';\n\nexport const CSTYLE_PID = Symbol();\nexport const CSTYLE_ADD = Symbol();\nexport const CSTYLE_DEL = Symbol();\nexport const CSTYLE_ATTACH = Symbol();\n\nexport function addParentStyleId(component, inheritIds, styleId) {\n  if (!inheritIds && !styleId) return;\n  let ids = component[CSTYLE_PID];\n  if (!ids) {\n    ids = component[CSTYLE_PID] = createEmptyObject();\n  }\n  if (inheritIds) {\n    assignObject(ids, inheritIds);\n  }\n  if (styleId) {\n    ids[styleId] = '';\n  }\n}\n\nfunction isHideCssExists() {\n  const $e = createElement('span', {\n    style: 'position:absolute;left:-10000px;',\n    class: 'jg-hide'\n  });\n  appendChild(document.body, $e);\n  return getCSPropertyValue(getComputedStyle($e), 'display') === 'none';\n}\n\nclass ComponentStyleManager {\n  constructor() {\n    this.m = new Map();\n    /**\n     * State\n     * 0: not attached\n     * 1: attached\n     */\n    this.s = 0;\n  }\n\n  _c(sty) {\n    if (this.s === 0) return;\n    const $style = createElement('style', {\n      type: 'text/css',\n      id: sty.dom\n    });\n    appendChild(document.head, $style);\n    if ($style.styleSheet) {\n      $style.styleSheet.cssText = sty.css;\n    } else {\n      $style.textContent = sty.css;\n    }\n  }\n\n  [CSTYLE_ADD](sty) {\n    if (!sty) return;\n    const styleMap = this.m;\n    let info = styleMap.get(sty.id);\n    if (info) {\n      info.refs++;\n      return;\n    }\n    info = {\n      id: sty.id,\n      css: sty.css,\n      dom: `__${sty.id}__`,\n      refs: 1\n    };\n    styleMap.set(sty.id, info);\n    this._c(info);\n  }\n\n  [CSTYLE_ATTACH]() {\n    if (this.s !== 0) return;\n    this.s = 1;\n    if (!isHideCssExists()) {\n      this._c({\n        dom: `__jgsty_${uid()}__`,\n        css: '.jg-hide{display:none!important}.jg-hide.jg-hide-enter,.jg-hide.jg-hide-leave{display:block!important}'\n      });\n    }\n    this.m.forEach(info => this._c(info));\n  }\n\n  [CSTYLE_DEL](sty) {\n    if (!sty) return;\n    const info = this.m.get(sty.id);\n    if (!info) return;\n    info.refs--;\n    if (info.refs > 0) {\n      return;\n    }\n    this.m.delete(info.id);\n    if (this.s === 0) return;\n    document.head.removeChild(\n      document.getElementById(info.dom)\n    );\n  }\n}\n\n// singleton\nexport const manager = new ComponentStyleManager();\n","import {\n  Symbol,\n  isString,\n  uid,\n  isFunction\n} from '../util';\nimport {\n  Messenger,\n  NOTIFY,\n  ON,\n  OFF\n} from './messenger';\n\nexport const I18N_GET_RENDER = Symbol();\nexport const I18N_GET_TEXT = Symbol();\nexport const I18N_GET_ATTR = Symbol();\nexport const I18N_LOCALE_CHANGE = Symbol();\nexport const I18N_SWITCH_LOCALE = Symbol();\nexport const I18N_RENDER_DEPS = Symbol();\nexport const I18N_CURRENT_LOCALE = Symbol();\n\nconst LAST_FETCHING_KEY = Symbol();\nconst CURRENT_DATA = Symbol();\nconst CACHE = Symbol();\n\nfunction compile(text) {\n  // eslint-disable-next-line no-new-func\n  return new Function('__ctx', `return \\`${text.replace(/\\$\\{\\s*([\\w\\d._$]+)\\s*\\}/g, (m, n) => {\n    return '${ __ctx.' + n + ' }';\n  })}\\`;`);\n}\n\nfunction defaultFetchFn(locale) {\n  return window.fetch('dist/locale.' + locale + '.js').then(res => res.text());\n}\n\nclass I18nService extends Messenger {\n  constructor(attrs) {\n    super(attrs);\n    this[I18N_RENDER_DEPS] = null;\n    this[CURRENT_DATA] = null;\n    this[CACHE] = new Map();\n    this[LAST_FETCHING_KEY] = null;\n\n    this.r(window.JINGE_I18N_DATA);\n  }\n\n  get locale() {\n    return this[CURRENT_DATA].locale;\n  }\n\n  /**\n   * Register locale data, will be called in locale resource script.\n   * Usually you don't need call this method manully.\n   */\n  r(data) {\n    if (!data || this[CACHE].has(data.locale)) {\n      return;\n    }\n    this[CACHE].set(data.locale, data);\n    if (!this[CURRENT_DATA]) {\n      this[CURRENT_DATA] = data;\n    }\n  }\n\n  /**\n   * switch to another locale/language\n   * @param {String} locale locale to swtiched\n   * @param {Function} fetchFn a function to fetch locale resource script.\n   */\n  switch(locale, fetchFn = defaultFetchFn) {\n    if (this[CURRENT_DATA].locale === locale) {\n      return;\n    }\n    const data = this[CACHE].get(locale);\n    if (!data) {\n      if (fetchFn) {\n        const key = uid();\n        this[LAST_FETCHING_KEY] = key;\n        fetchFn(locale).then(code => {\n          // eslint-disable-next-line no-new-func\n          (new Function('JINGE_I18N_SERVICE', code))(this);\n          if (this[LAST_FETCHING_KEY] !== key || this[CURRENT_DATA].locale === locale) {\n            /*\n             * ignore if callback has been expired.\n             * 使用闭包的技巧来检测当前回调是否已经过期，\n             * 即，是否已经有新的 fetchFn 函数的调用。\n             */\n            return;\n          }\n          const data = this[CACHE].get(locale);\n          this[CURRENT_DATA] = data;\n          this[NOTIFY](I18N_LOCALE_CHANGE, this.locale);\n        });\n      } else {\n        throw new Error(`i18n data of \"${locale}\" is not found. `);\n      }\n    } else {\n      this[CURRENT_DATA] = data;\n      this[NOTIFY](I18N_LOCALE_CHANGE, this.locale);\n    }\n  }\n\n  [I18N_GET_TEXT](key, params) {\n    const dict = this[CURRENT_DATA].dictionary;\n    if (!(key in dict)) {\n      return 'i18n_missing';\n    }\n    let text = dict[key];\n    if (isString(text)) {\n      // text.startsWith(\"«\") means reference to another key\n      if (text.charCodeAt(0) === 171) {\n        text = dict[text.substring(1)];\n      } else {\n        text = compile(text);\n      }\n      dict[key] = text;\n    }\n    return text(params);\n  }\n\n  [I18N_GET_RENDER](key) {\n    return getRenderOrAttr(this[CURRENT_DATA], this[I18N_RENDER_DEPS], 'render', key);\n  }\n\n  [I18N_GET_ATTR](key) {\n    return getRenderOrAttr(this[CURRENT_DATA], this[I18N_RENDER_DEPS], 'attribute', key);\n  }\n\n  /**\n   * Bind listener to LOCALE_CHANGE event,\n   * return a function auto remove this listener\n   * @param {Function} handler a listener bind to LOCALE_CHANGE event\n   * @param {Boolean} immediate call listener immediately, default is false.\n   * @returns {Function} a function auto remove listener\n   */\n  watch(listener, immediate) {\n    this[ON](I18N_LOCALE_CHANGE, listener);\n    if (immediate) listener(this.locale);\n    return function unwatcher() {\n      this[OFF](I18N_LOCALE_CHANGE, listener);\n    };\n  }\n}\n\nfunction getRenderOrAttr(data, depFns, type, key) {\n  let renderOrAttr = data[type];\n  if (isFunction(renderOrAttr)) {\n    data[type] = renderOrAttr = (depFns ? renderOrAttr(...depFns[type]) : {});\n  }\n  if (!(key in renderOrAttr)) {\n    throw new Error(`missing i18n ${type} for key: ${key}`);\n  }\n  let fn = renderOrAttr[key];\n  if (isString(fn)) {\n    // if fn is string, it's a reference to another key.\n    renderOrAttr[key] = fn = renderOrAttr[fn];\n  }\n  return fn;\n}\n\n/* Singleton */\nexport const i18n = new I18nService();\n\n/**\n * Compiler helper function, the first parameter will be convert to i18n dictionary key,\n * and the whole function will be transform to `i18nService[GET_TEXT](key, params)`\n *\n * But after i18n locale resource script had been written, compiler won't transform it,\n * the function will work as text parse util.\n *\n * @param {String|Object} text\n * @param {Object} params\n */\nexport function _t(text, params) {\n  return params ? compile(text)(params) : text;\n}\n","import {\n  Symbol,\n  isDOMNode,\n  assertFail,\n  isFunction,\n  STR_DEFAULT,\n  isObject,\n  isArray,\n  createEmptyObject,\n  setImmediate,\n  clearImmediate,\n  assignObject,\n  BEFORE_DESTROY_EVENT_NAME,\n  AFTER_RENDER_EVENT_NAME,\n  getOwnPropertyNames,\n  getOwnPropertySymbols,\n  arrayRemove,\n  getOrCreateMapProperty,\n  getOrCreateArrayProperty,\n  getParent,\n  removeChild,\n  replaceChild,\n  appendChild,\n  registerEvent\n} from '../util';\nimport {\n  VM_ATTRS,\n  VM_DESTROY,\n  VM_NOTIFIABLE,\n  VM_REMOVE_PARENT,\n  VM_HOST,\n  VM_RELATED_LISTENERS,\n  wrapComponent,\n  VM_SETTER_FN_MAP\n} from '../vm';\nimport {\n  Messenger,\n  LISTENERS,\n  CLEAR,\n  NOTIFY\n} from './messenger';\nimport {\n  manager as StyleManager,\n  CSTYLE_PID,\n  CSTYLE_ADD,\n  CSTYLE_DEL,\n  CSTYLE_ATTACH\n} from './style';\nimport {\n  i18n as i18nService\n} from './i18n';\n\nexport const NOTIFY_TRANSITION = Symbol();\nexport const TEMPLATE_RENDER = Symbol();\nexport const RENDER = Symbol();\nexport const RENDER_TO_DOM = Symbol();\nexport const ARG_COMPONENTS = Symbol();\nexport const PASSED_ATTRS = Symbol();\nexport const CLONE = Symbol();\nexport const DESTROY = Symbol();\nexport const CONTEXT = Symbol();\nexport const CONTEXT_STATE = Symbol();\nexport const ROOT_NODES = Symbol();\nexport const NON_ROOT_COMPONENT_NODES = Symbol();\nexport const REF_NODES = Symbol();\nexport const SET_REF_NODE = Symbol();\nexport const REF_BELONGS = Symbol();\nexport const RELATED_DOM_REFS = Symbol();\nexport const GET_STATE_NAME = Symbol();\nexport const AFTER_RENDER = Symbol();\nexport const HANDLE_AFTER_RENDER = Symbol();\nexport const HANDLE_BEFORE_DESTROY = Symbol();\nexport const GET_FIRST_DOM = Symbol();\nexport const GET_LAST_DOM = Symbol();\nexport const GET_TRANSITION_DOM = Symbol();\nexport const BEFORE_DESTROY = Symbol();\nexport const GET_CONTEXT = Symbol();\nexport const SET_CONTEXT = Symbol();\nexport const GET_REF = Symbol();\nexport const UPDATE = Symbol();\nexport const UPDATE_IF_NEED = Symbol();\nexport const UPDATE_NEXT_MAP = Symbol();\nexport const STATE = Symbol();\nexport const STATE_INITIALIZE = 0;\nexport const STATE_RENDERED = 1;\nexport const STATE_WILLDESTROY = 2;\nexport const STATE_DESTROIED = 4;\nexport const STATE_NAMES = [\n  'initialize', 'rendered', 'willdestroy', 'destroied'\n];\n\nexport const DOM_ON = Symbol();\nexport const DOM_PASS_LISTENERS = Symbol();\n\nexport const I18N_WATCH = Symbol();\nconst DOM_LISTENER_DEREGISTERS = Symbol();\nconst I18N_LISTENER_DEREGISTERS = Symbol();\n\nfunction copyContext(context) {\n  if (!context) return null;\n  return assignObject(createEmptyObject(), context);\n}\n\nexport class Component extends Messenger {\n  /**\n   * compiler will auto transform the `template` getter's return value from String to Render Function.\n   */\n  static get template() {\n    return null;\n  }\n\n  static get style() {\n    return null;\n  }\n\n  /**\n   * @param {Attributes} attrs Attributes passed from parent Component\n   */\n  constructor(attrs) {\n    if (!isObject(attrs) || !(VM_ATTRS in attrs)) {\n      throw new Error('First argument passed to Component constructor must be ViewModel with Messenger interface. See https://[todo]');\n    }\n    super(attrs[LISTENERS]);\n\n    this[PASSED_ATTRS] = attrs;\n\n    this[VM_ATTRS] = null;\n    this[VM_SETTER_FN_MAP] = null;\n\n    this[UPDATE_NEXT_MAP] = null;\n    this[CSTYLE_PID] = null;\n    this[CONTEXT] = attrs[CONTEXT];\n    this[CONTEXT_STATE] = 0;\n    this[ARG_COMPONENTS] = attrs[ARG_COMPONENTS];\n    this[STATE] = STATE_INITIALIZE;\n    /**\n     * ROOT_NODES means root children of this component,\n     *   include html-nodes and component-nodes.\n     * We use this infomation to remove DOM after this component is destroied.\n     * We do not maintain the whole parent-child view-tree but only root children,\n     * because when we remove the root children, whole view-tree will be\n     * removed, so we do not need waste memory to maintain whole view-tree.\n     */\n    this[ROOT_NODES] = [];\n    /**\n     * NON_ROOT_COMPONENT_NODES means nearest non-root component-nodes in the view-tree.\n     * Node in view-tree have two types, html-node and component-node.\n     *   html-node include html dom node and html text node,\n     *   component-node is an instance of a Component.\n     * For example, we have rendered a view-tree:\n     *             RootApp(Component)\n     *             /     |          \\\n     *         h1(Html)  h2(Html)  A(Component)\n     *            |                 |\n     *        C(Component)     D(Component)\n     *\n     * The nearest non-root component-nodes of RootApp include C,\n     *   but not include A(as it's root) or D(as it's not nearest).\n     *\n     * By the way, the ROOT_NODES of view-tree above is [h1, h2, A]\n     */\n    this[NON_ROOT_COMPONENT_NODES] = [];\n    /**\n     * REF_NODES contains all children with ref: attribute.\n     * REF_BELONGS contains all parent components which has this component as ref.\n     *\n     * 使用 ref: 标记的元素（Component 或 html node），会保存在 REF_NODES 中，\n     *   之后通过 GET_REF 函数可以获取到元素实例。\n     * 当标记的元素属于 <if> 或 <for> 等组件的 slot 时，这些元素可能被动态产生或销毁。\n     *   需要在元素产生或销毁时，相应地把它从它所属于的 REF_NODES 中添加或删除。\n     * 为了实现这个目的，对于 Component 元素，在将它添加到目标父组件的 REF_NODES 中的同时，\n     *   会将目标父组件反向记录到该元素的 REF_BELONGS 中，从而实现当该元素被销毁时，\n     *   可以将自己从它所属于的 REF_NODES 中删除；\n     * 对于 html node 元素，我们会将其目标父组件记录到该元素的渲染关联组件的 RELATED_DOM_REFS。\n     *   比如说，如果该 html 元素是 <if> 组件的 slot ，那它的渲染关联组件就是 <if> 内部的 Slot 组件，\n     *   当 <if> 的条件发生变化时，实际上会销毁这个 Slot 组件。由于前面提到的 html 元素\n     *   的 ref: 信息记录到了该 Slot 组件的 RELATED_DOM_REFS 里，因此就能反向地将\n     *   这个 html 元素从它所属于的 REF_NODES 中删除。\n     */\n    this[REF_NODES] = null;\n    this[REF_BELONGS] = null;\n    this[RELATED_DOM_REFS] = null;\n\n    /**\n     * If some child of this component is passed as argument(ie.\n     * use arg:pass attribute) like ng-tranclude in angular 1.x,\n     * the child may contain some messenger listeners not belong to\n     * this component but belong to outer parent.\n     *\n     * When destroy this component, we should also remove messenger listeners\n     *   belong to outer parent to prevent memory leak.\n     * To implement this goal, we maitain VM_RELATED_LISTENERS.\n     * When render view-tree, any messenger listeners belong to outer\n     * parent, will be also linked under VM_RELATED_LISTENERS, then\n     * when we destroy this component, the listeners can also be clear.\n     *\n     * For examle:\n     *\n     * <!-- outer parent: RootApp -->\n     * <div>\n     * <if expect=\"show\">\n     * <Tooltip>\n     * <argument arg:pass=\"default\">\n     * <p>hello, world. my name is ${name}</p>\n     * </argument>\n     * </Tooltip>\n     * </if>\n     * </div>\n     *\n     * when the `show` variable changed from true to false, the\n     * Tooltip component will be destroy. The messenger listener belong\n     * to the outer parent RootApp which watch `name` variable should\n     * also be removed.\n     */\n    this[VM_RELATED_LISTENERS] = null;\n\n    // saved listener deregisters, will be auto called when component is destroied\n    this[DOM_LISTENER_DEREGISTERS] = null;\n    this[I18N_LISTENER_DEREGISTERS] = null;\n\n    return wrapComponent(this);\n  }\n\n  /**\n   * Helper function to add i18n LOCALE_CHANGE listener.\n   * Return deregister function which will remove event listener.\n   * If you do dot call deregister function, it will be auto called when component is destroied.\n   * @param {Function} listener listener bind to LOCALE_CHANGE event.\n   * @param {Boolean} immediate call listener immediately, useful for component property initialize\n   * @returns {Function} deregister function to remove listener\n   */\n  [I18N_WATCH](listener, immediate) {\n    const deregs = getOrCreateArrayProperty(\n      this,\n      I18N_LISTENER_DEREGISTERS\n    );\n    const unwatcher = i18nService.watch(() => {\n      // bind component to listener's function context.\n      listener.call(this);\n    }, immediate);\n    const deregister = () => {\n      unwatcher();\n      arrayRemove(deregs, deregister);\n    };\n    deregs.push(deregister);\n    return deregister;\n  }\n\n  /**\n   * Helper function to add dom event listener.\n   * Return deregister function which will remove event listener.\n   * If you do dot call deregister function, it will be auto called when component is destroied.\n   * @param {HtmlElement} $el\n   * @param {String} eventName\n   * @param {Function} listener\n   * @param {Boolean|Object} capture\n   * @returns {Function} deregister function to remove listener\n   */\n  [DOM_ON]($el, eventName, listener, capture) {\n    const lisDeregister = registerEvent($el, eventName, $event => {\n      // bind component to listener's function context.\n      listener.call(this, $event);\n    }, capture);\n\n    const deregs = getOrCreateArrayProperty(this, DOM_LISTENER_DEREGISTERS);\n    const deregister = () => {\n      lisDeregister();\n      arrayRemove(deregs, deregister);\n    };\n    deregs.push(deregister);\n    return deregister;\n  }\n\n  /**\n   * Helper function to pass all listener to first dom element.\n   * @param {Array} ignoredEventNames event names not passed\n   */\n  [DOM_PASS_LISTENERS](ignoredEventNames) {\n    if (this[STATE] !== STATE_RENDERED) {\n      throw new Error('bindDOMListeners must be applied to component which is rendered.');\n    }\n    const lis = this[LISTENERS];\n    if (!lis || lis.length === 0) {\n      return;\n    }\n    const $el = this[GET_FIRST_DOM]();\n    if ($el.nodeType !== Node.ELEMENT_NODE) {\n      return;\n    }\n    lis.forEach((handlers, eventName) => {\n      if (ignoredEventNames && ignoredEventNames.indexOf(eventName) >= 0) {\n        return;\n      }\n      handlers.forEach(fn => {\n        this[DOM_ON]($el, eventName, fn.tag ? $evt => {\n          fn.tag.stop && $evt.stopPropagation();\n          fn.tag.prevent && $evt.preventDefault();\n          fn($evt);\n        } : fn);\n      });\n    });\n  }\n\n  [GET_TRANSITION_DOM]() {\n    const rns = this[ROOT_NODES];\n    if (rns.length === 0) assertFail();\n    const el = rns[0];\n    return isComponent(el) ? el[GET_TRANSITION_DOM]() : el;\n  }\n\n  [GET_FIRST_DOM]() {\n    const rns = this[ROOT_NODES];\n    if (rns.length === 0) assertFail();\n    const el = rns[0];\n    return isComponent(el) ? el[GET_FIRST_DOM]() : el;\n  }\n\n  [GET_LAST_DOM]() {\n    const rns = this[ROOT_NODES];\n    if (rns.length === 0) assertFail();\n    const el = rns[rns.length - 1];\n    return isComponent(el) ? el[GET_LAST_DOM]() : el;\n  }\n\n  [CLONE]() {\n    throw new Error('abstract method');\n  }\n\n  [RENDER]() {\n    const Clazz = this.constructor;\n    let renderFn = Clazz.template;\n    if (!renderFn && this[ARG_COMPONENTS]) {\n      renderFn = this[ARG_COMPONENTS][STR_DEFAULT];\n    }\n    if (!isFunction(renderFn)) {\n      assertFail(`render function of ${Clazz.name} not found. Forget static getter \"template\"?`);\n    }\n    StyleManager[CSTYLE_ADD](Clazz.style);\n    return renderFn(this);\n  }\n\n  /**\n   *\n   * @param {HTMLElement} $targetDOM\n   * @param {Boolean} replaceMode if false, use append mode\n   */\n  [RENDER_TO_DOM]($targetDOM, replaceMode = true) {\n    if (!isDOMNode($targetDOM)) assertFail();\n    if (this[STATE] !== STATE_INITIALIZE) {\n      assertFail();\n    }\n    const rr = assertRenderResults(this[RENDER]());\n    StyleManager[CSTYLE_ATTACH]();\n    if (replaceMode) {\n      replaceChild(getParent($targetDOM), rr, $targetDOM);\n    } else {\n      appendChild($targetDOM, rr);\n    }\n    this[HANDLE_AFTER_RENDER]();\n  }\n\n  [DESTROY](removeDOM = true) {\n    if (this[STATE] > STATE_WILLDESTROY) return;\n    this[STATE] = STATE_WILLDESTROY;\n    /*\n     * once component is being destroied,\n     *   we mark component and it's passed-attrs un-notifiable to ignore\n     *   possible messeges occurs in BEFORE_DESTROY lifecycle callback.\n     */\n    this[VM_ATTRS][VM_NOTIFIABLE] = false;\n    this[PASSED_ATTRS][VM_ATTRS][VM_NOTIFIABLE] = false;\n\n    // notify before destroy lifecycle\n    // 需要注意，必须先 NOTIFY 向外通知销毁消息，再执行 BEFORE_DESTROY 生命周期函数。\n    //   因为在 BEFORE_DESTROY 里会销毁外部消息回调函数里可能会用到的属性等资源。\n    this[NOTIFY](BEFORE_DESTROY_EVENT_NAME, this);\n    this[BEFORE_DESTROY]();\n    // destroy children(include child component and html nodes)\n    this[HANDLE_BEFORE_DESTROY](removeDOM);\n    // clear messenger listeners.\n    super[CLEAR]();\n    // remove component style\n    StyleManager[CSTYLE_DEL](this.constructor.style);\n    // destroy attrs passed to constructor\n    const attrs = this[PASSED_ATTRS];\n    attrs[VM_ATTRS][VM_DESTROY]();\n    // unlink all symbol property. may be unnecessary.\n    getOwnPropertySymbols(attrs, p => {\n      attrs[p] = null;\n    });\n\n    /*\n     * reset HOST object's all public properties to null\n     *   to remove HOST object from old property value's VM_PARENTS\n     *\n     * 将所有公共属性的属性值重置为 null，从而解除 ViewModel 之间的 VM_PARENTS 关联，回收资源和防止潜在 bug。\n     *   使用 getOwnPropertyNames 可以获取所有属性，但无法获取 setter 函数定义的属性。\n     *   因此，先从 VM_SETTER_FN_MAP 中取到所有使用过的属性，主动调用属性值的 REMOVE_PARENT；然后使用 getOwnPropertyNames 简单地重置 null。\n     */\n    const sfm = this[VM_SETTER_FN_MAP];\n    if (sfm) {\n      sfm.forEach((fn, prop) => {\n        if (fn === null) return;\n        const v = this[prop];\n        if (isObject(v) && (VM_ATTRS in v)) {\n          v[VM_ATTRS][VM_REMOVE_PARENT](\n            this[VM_ATTRS][VM_HOST],\n            prop\n          );\n        }\n      });\n      sfm.clear();\n      this[VM_SETTER_FN_MAP] = null;\n    }\n    getOwnPropertyNames(this, prop => {\n      if (isObject(this[prop])) {\n        this[prop] = null;\n      }\n    });\n    // destroy view model, it's import to pass false as argument\n    this[VM_ATTRS][VM_DESTROY](false);\n\n    // clear next tick update setImmediate\n    const unm = this[UPDATE_NEXT_MAP];\n    if (unm) {\n      unm.forEach(imm => {\n        clearImmediate(imm);\n      });\n      unm.clear();\n      this[UPDATE_NEXT_MAP] = null;\n    }\n\n    // destroy related refs:\n    destroyRelatedRefs(this);\n    // clear context.\n    destroyContext(this);\n    // clear all dom event listener and i18n watcher\n    releaseDeregisters(this, DOM_LISTENER_DEREGISTERS);\n    releaseDeregisters(this, I18N_LISTENER_DEREGISTERS);\n\n    // clear properties\n    this[STATE] = STATE_DESTROIED;\n    // unlink all symbol properties. maybe unnecessary.\n    this[VM_SETTER_FN_MAP] =\n      this[PASSED_ATTRS] =\n      this[NON_ROOT_COMPONENT_NODES] =\n      this[ROOT_NODES] =\n      this[REF_NODES] =\n      this[REF_BELONGS] =\n      this[ARG_COMPONENTS] = null;\n    // unlink VM_ATTRS, mark component destroied\n    // 这行代码必须放在最后，因为在 ../viewmodel/proxy.js 里面，\n    //   需要使用 VM_ATTRS 是否存在来判断组件是否已经销毁。\n    this[VM_ATTRS] = null;\n  }\n\n  [HANDLE_BEFORE_DESTROY](removeDOM) {\n    this[NON_ROOT_COMPONENT_NODES].forEach(component => {\n      // it's not necessary to remove dom when destroy non-root component,\n      // because those dom nodes will be auto removed when their parent dom is removed.\n      component[DESTROY](false);\n    });\n    this[NON_ROOT_COMPONENT_NODES].length = 0;\n\n    let $parent;\n    this[ROOT_NODES].forEach(node => {\n      if (isComponent(node)) {\n        node[DESTROY](removeDOM);\n      } else if (removeDOM) {\n        if (!$parent) {\n          $parent = getParent(node);\n        }\n        removeChild($parent, node);\n      }\n    });\n    this[ROOT_NODES].length = 0;\n  }\n\n  [HANDLE_AFTER_RENDER]() {\n    /*\n     * Set NOTIFIABLE=true to enable ViewModel notify.\n     * Don't forgot to add these code if you override HANDLE_AFTER_RENDER\n     */\n    this[PASSED_ATTRS][VM_ATTRS][VM_NOTIFIABLE] = true;\n    this[VM_ATTRS][VM_NOTIFIABLE] = true;\n\n    this[ROOT_NODES].forEach(n => {\n      if (isComponent(n)) n[HANDLE_AFTER_RENDER]();\n    });\n    this[NON_ROOT_COMPONENT_NODES].forEach(n => {\n      if (isComponent(n)) n[HANDLE_AFTER_RENDER]();\n    });\n    this[STATE] = STATE_RENDERED;\n    this[CONTEXT_STATE] = this[CONTEXT_STATE] > 0 ? -2 : -1; // has been rendered, can't modify context\n    this[AFTER_RENDER]();\n    this[NOTIFY](AFTER_RENDER_EVENT_NAME, this);\n  }\n\n  /**\n   *\n   * @param {Function|boolean} handler\n   * @param {boolean} nextTick\n   */\n  [UPDATE_IF_NEED](handler = null, nextTick = true) {\n    if (this[STATE] !== STATE_RENDERED) {\n      return;\n    }\n    if (handler === false) {\n      return this[UPDATE]();\n    }\n\n    if (!isFunction(handler)) {\n      handler = this[UPDATE];\n    }\n\n    if (!nextTick) {\n      handler.call(this);\n      return;\n    }\n\n    const ntMap = getOrCreateMapProperty(this, UPDATE_NEXT_MAP);\n    if (ntMap.has(handler)) {\n      // already in queue.\n      return;\n    }\n    ntMap.set(handler, setImmediate(() => {\n      ntMap.delete(handler);\n      handler.call(this);\n    }));\n  }\n\n  [UPDATE]() {\n    throw new Error('abstract method');\n  }\n\n  [GET_STATE_NAME]() {\n    return STATE_NAMES[this[STATE]];\n  }\n\n  [SET_CONTEXT](id, ctx, forceOverride = false) {\n    if (this[CONTEXT_STATE] < 0) {\n      throw new Error('Can\\'t setContext after component has been rendered. Try put setContext code into constructor.');\n    }\n    if (this[CONTEXT_STATE] === 0) {\n      // we copy context to make sure child component do not modify context passed from parent.\n      // we do not copy it by default until setContext function is called, because it unnecessary to waste memory if\n      // child component do not modify the context.\n      if (!this[CONTEXT]) {\n        this[CONTEXT] = createEmptyObject();\n      } else {\n        this[CONTEXT] = copyContext(this[CONTEXT]);\n      }\n      this[CONTEXT_STATE] = 1; // has been copied.\n    }\n    if (id in this[CONTEXT]) {\n      // override exist may case hidden bug hard to debug.\n      // so we force programmer to pass third argument to\n      //   tell us he/she know what he/she is doing.\n      if (!forceOverride) {\n        throw new Error(`Contenxt with id: ${id.toString()} is exist. Pass third argument forceOverride=true to override it.`);\n      }\n    }\n    this[CONTEXT][id] = ctx;\n  }\n\n  [GET_CONTEXT](id) {\n    return this[CONTEXT] ? this[CONTEXT][id] : null;\n  }\n\n  [SET_REF_NODE](ref, el, relatedComponent) {\n    const rns = getOrCreateMapProperty(this, REF_NODES);\n    let elOrArr = rns.get(ref);\n    if (!elOrArr) {\n      rns.set(ref, el);\n    } else if (isArray(elOrArr)) {\n      elOrArr.push(el);\n    } else {\n      elOrArr = [elOrArr, el];\n      rns.set(ref, elOrArr);\n    }\n    if (isComponent(el)) {\n      getOrCreateArrayProperty(el, REF_BELONGS).push([\n        this, ref\n      ]);\n      return;\n    }\n    if (this === relatedComponent) {\n      return;\n    }\n    getOrCreateArrayProperty(\n      relatedComponent, RELATED_DOM_REFS\n    ).push([this, ref, el]);\n  }\n\n  /**\n   * Get child node(or nodes) marked by 'ref:' attribute in template\n   * @param {String} ref\n   * @returns {Node|Array<Node>}\n   */\n  [GET_REF](ref) {\n    if (this[STATE] !== STATE_RENDERED) {\n      console.error(`Warning: call getChild before component '${this.constructor.name}' is rendered will get nothing, try put getChild into afterRender lifecycle hook.`);\n    }\n    return this[REF_NODES] ? this[REF_NODES].get(ref) : null;\n  }\n\n  /**\n   * lifecycle hook, called after rendered.\n   */\n  [AFTER_RENDER]() {\n    // lifecycle hook, default do nothing.\n  }\n\n  /**\n   * lifecycle hook, called before destroy.\n   */\n  [BEFORE_DESTROY]() {\n    // lifecycle hook, default do nothing.\n  }\n}\n\nfunction destroyContext(comp) {\n  const ctx = comp[CONTEXT];\n  if (!ctx) return;\n  if (comp[CONTEXT_STATE] === -2) {\n    // maybe unnecessary to reset properties\n    getOwnPropertyNames(ctx, propN => {\n      ctx[propN] = null;\n    });\n    getOwnPropertySymbols(ctx, propN => {\n      ctx[propN] = null;\n    });\n  }\n  comp[CONTEXT] = null;\n}\n\nfunction releaseDeregisters(component, nameOfDeregisters) {\n  if (component[nameOfDeregisters]) {\n    component[nameOfDeregisters].forEach(deregister => deregister());\n    component[nameOfDeregisters] = null;\n  }\n}\n\nexport function destroyRelatedRefs(comp) {\n  function _unref(refBelongs, el) {\n    if (!refBelongs) return;\n    refBelongs.forEach(info => {\n      const map = info[0][REF_NODES];\n      if (!map) return;\n      const rns = map.get(info[1]);\n      if (isArray(rns)) {\n        arrayRemove(rns, el || info[2]);\n      } else {\n        map.delete(info[1]);\n      }\n    });\n  }\n  _unref(comp[REF_BELONGS], comp);\n  _unref(comp[RELATED_DOM_REFS]);\n}\n\nexport function isComponent(c) {\n  return ROOT_NODES in c;\n}\n\nexport function assertRenderResults(renderResults) {\n  if (!isArray(renderResults) || renderResults.length === 0) {\n    throw new Error('Render results of component is empty');\n  }\n  return renderResults;\n}\n\nexport function operateRootHtmlDOM(fn, el, ...args) {\n  if (!isComponent(el)) return fn(el, ...args);\n  el[ROOT_NODES].forEach(ce => {\n    operateRootHtmlDOM(fn, ce, ...args);\n  });\n}\n","\nimport {\n  VM_ATTRS as VM_ATTRS_b36c9d60a9,\n  VM_ON as VM_ON_b36c9d60a9,\n  wrapComponent as wrapComponent_b36c9d60a9\n} from '..';\nimport {\n  Component,\n  RENDER,\n  ROOT_NODES,\n  ARG_COMPONENTS,\n  UPDATE_IF_NEED,\n  UPDATE,\n  DESTROY,\n  isComponent,\n  GET_FIRST_DOM,\n  CONTEXT,\n  HANDLE_AFTER_RENDER,\n  GET_LAST_DOM,\n  STATE,\n  STATE_RENDERED,\n  CSTYLE_PID,\n  addParentStyleId\n} from '../core';\nimport {\n  isArray,\n  Symbol,\n  STR_DEFAULT,\n  isObject,\n  assertFail,\n  STR_EMPTY,\n  STR_LENGTH,\n  isNumber,\n  isString,\n  createComment,\n  createFragment,\n  appendChild,\n  getParent,\n  insertBefore,\n  removeChild,\n  insertAfter\n} from '../util';\nimport {\n  wrapAttrs,\n  VM_DEBUG_NAME,\n  vmWatch,\n  VM_ATTRS,\n  isInnerObj\n} from '../vm';\n\nexport const FOR_LENGTH = Symbol();\nexport const FOR_KEYS = Symbol();\nexport const FOR_KEY_NAME = Symbol();\nexport const FOR_WAIT_UPDATE = Symbol();\nexport const FOR_UPDATE_ITEM = Symbol();\n\nconst KEY_INDEX = 'index';\nconst KEY_EACH = 'each';\nconst EMP_ARR = [];\n\nexport class ForEachComponent extends Component {\n  constructor(attrs, item, index, isLast) {\n    const vm_b36c9d60a9 = super(attrs);\n    vm_b36c9d60a9.each = item;\n    vm_b36c9d60a9.index = index;\n    vm_b36c9d60a9.isFirst = index === 0;\n    vm_b36c9d60a9.isLast = isLast;\n    return vm_b36c9d60a9;\n  }\n\n  [RENDER]() {\n    const renderFn = this[ARG_COMPONENTS][STR_DEFAULT];\n    if (!renderFn) assertFail();\n    return renderFn(this);\n  }\n}\n\nfunction createEl(item, i, isLast, itemRenderFn, context, cstyPid) {\n  const el = new ForEachComponent(wrapAttrs({\n    [VM_DEBUG_NAME]: 'attrs_of_<for-each>',\n    [VM_ATTRS]: null,\n    [CONTEXT]: context,\n    [ARG_COMPONENTS]: {\n      [STR_DEFAULT]: itemRenderFn\n    }\n  }), item, i, isLast);\n  cstyPid && addParentStyleId(el, cstyPid);\n  return el;\n}\n\nfunction appendRenderEach(item, i, isLast, itemRenderFn, roots, context, cstyPid) {\n  const el = createEl(item, i, isLast, itemRenderFn, context, cstyPid);\n  roots.push(el);\n  return el[RENDER]();\n}\n\nfunction _assertVm(item, i) {\n  if (isObject(item) && !isInnerObj(item) && !(VM_ATTRS in item)) {\n    throw new Error(`loop item [${i}] of <for> component must be ViewModel.`);\n  }\n}\n\nfunction _prepareKey(item, i, keyMap, keyName) {\n  const key = keyName === KEY_EACH ? item : keyName(item);\n  if (keyMap.has(key)) {\n    console.error(`loop items [${i}] and [${keyMap.get(key)}] of <for> component both have key '${key}', dulplicated key may cause update error.`);\n  }\n  keyMap.set(key, i);\n  return key;\n}\n\nfunction renderItems(items, itemRenderFn, roots, keys, keyName, context, cstyPid) {\n  const result = [];\n  const tmpKeyMap = new Map();\n  items.forEach((item, i) => {\n    _assertVm(item, i);\n    if (keyName !== KEY_INDEX) {\n      keys.push(_prepareKey(item, i, tmpKeyMap, keyName));\n    }\n    result.push(...appendRenderEach(item, i, i === items.length - 1, itemRenderFn, roots, context, cstyPid));\n  });\n  return result;\n}\n\nfunction loopAppend($parent, el) {\n  el[ROOT_NODES].forEach(node => {\n    if (isComponent(node)) {\n      loopAppend($parent, node);\n    } else {\n      appendChild($parent, node);\n    }\n  });\n}\n\nfunction updateEl(el, i, items) {\n  if (el.isFirst !== (i === 0)) {\n    el.isFirst = i === 0;\n  }\n  if (el.isLast !== (i === items.length - 1)) {\n    el.isLast = (i === items.length - 1);\n  }\n  if (el.index !== i) {\n    el.index = i;\n  }\n  if (el.each !== items[i]) {\n    el.each = items[i];\n  }\n}\n\nfunction _parseIndexPath(p) {\n  return (isString(p) && p !== STR_LENGTH && /^\\d+$/.test(p)) ? Number(p) : p;\n}\n\nlet INC = 0;\nconst ID = Symbol();\n\nexport class ForComponent extends Component {\n  constructor(attrs) {\n    if (attrs.key && !/^(index|each(.[\\w\\d$_]+)*)$/.test(attrs.key)) {\n      throw new Error('Value of \"_key\" attribute of <for> component is invalidate. See https://[todo]');\n    }\n    const vm_b36c9d60a9 = super(attrs);\n    const fn_b36c9d60a9_2 = () => {\n      vm_b36c9d60a9.loop = attrs.loop;\n    };\n    fn_b36c9d60a9_2();\n    attrs[VM_ATTRS_b36c9d60a9][VM_ON_b36c9d60a9]('loop', fn_b36c9d60a9_2);\n    vm_b36c9d60a9[ID] = INC++;\n    const kn = attrs.key || KEY_INDEX;\n    vm_b36c9d60a9[FOR_KEY_NAME] = kn;\n    vm_b36c9d60a9[FOR_LENGTH] = 0;\n    vm_b36c9d60a9[FOR_KEYS] = null;\n    vm_b36c9d60a9[FOR_WAIT_UPDATE] = false;\n    if (kn !== KEY_INDEX && kn !== KEY_EACH) {\n      vm_b36c9d60a9[FOR_KEY_NAME] = new Function(KEY_EACH, `return ${ kn }`);\n      const propCount = kn.split('.').length + 1;\n      vmWatch(this, 'loop.*.' + kn.slice(5), propPath => {\n        if (propPath.length !== propCount || vm_b36c9d60a9[FOR_WAIT_UPDATE]) {\n          return;\n        }\n        const items = vm_b36c9d60a9.loop;\n        if (!isArray(items) || items.length === 0)\n          return;\n        const p = _parseIndexPath(propPath[1]);\n        if (!isNumber(p) || p >= items.length) {\n          return;\n        }\n        vm_b36c9d60a9[FOR_KEYS][p] = vm_b36c9d60a9[FOR_KEY_NAME](items[p]);\n      });\n    }\n    vmWatch(this, 'loop.*', propPath => {\n      if (vm_b36c9d60a9[STATE] !== STATE_RENDERED || propPath.length !== 2 || vm_b36c9d60a9[FOR_WAIT_UPDATE]) {\n        return;\n      }\n      const p = _parseIndexPath(propPath[1]);\n      if (p === STR_LENGTH) {\n        vm_b36c9d60a9[FOR_WAIT_UPDATE] = true;\n        vm_b36c9d60a9[UPDATE_IF_NEED]();\n      } else if (isNumber(p)) {\n        vm_b36c9d60a9[FOR_UPDATE_ITEM](p);\n      }\n    });\n    return vm_b36c9d60a9;\n  }\n\n  get loop() {\n    return this._l;\n  }\n\n  set loop(v) {\n    // console.log('set loop');\n    this._l = v;\n    this[FOR_WAIT_UPDATE] = true;\n    this[UPDATE_IF_NEED]();\n  }\n\n  [RENDER]() {\n    const roots = this[ROOT_NODES];\n    const itemRenderFn = this[ARG_COMPONENTS] ? this[ARG_COMPONENTS][STR_DEFAULT] : null;\n    if (!itemRenderFn) {\n      roots.push(createComment(STR_EMPTY));\n      return roots;\n    }\n    const items = this.loop;\n    const keyName = this[FOR_KEY_NAME];\n    if (keyName !== KEY_INDEX) this[FOR_KEYS] = [];\n    if (!isArray(items) || items.length === 0) {\n      roots.push(createComment(STR_EMPTY));\n      return roots;\n    }\n    this[FOR_LENGTH] = items.length;\n    return renderItems(\n      items,\n      itemRenderFn,\n      roots,\n      this[FOR_KEYS],\n      keyName,\n      this[CONTEXT],\n      this[CSTYLE_PID]\n    );\n  }\n\n  [FOR_UPDATE_ITEM](index) {\n    const items = this.loop;\n    const roots = this[ROOT_NODES];\n    if (!isArray(items) || index >= roots.length) return;\n    const keys = this[FOR_KEYS];\n    const item = items[index];\n    const oldEl = roots[index];\n    if (oldEl.each === item) {\n      return;\n    }\n    const itemRenderFn = this[ARG_COMPONENTS] ? this[ARG_COMPONENTS][STR_DEFAULT] : null;\n    if (!itemRenderFn) return;\n    // console.log('update item:', index);\n    const keyName = this[FOR_KEY_NAME];\n    if (keyName !== KEY_INDEX) {\n      const newKey = keyName === KEY_EACH ? item : keyName(item);\n      const oldKey = keys[index];\n      if (newKey !== oldKey) {\n        const $fd = oldEl[GET_FIRST_DOM]();\n        const newEl = createEl(\n          item, index, oldEl.isLast,\n          itemRenderFn, this[CONTEXT], this[CSTYLE_PID]\n        );\n        const rr = newEl[RENDER]();\n        insertBefore(getParent($fd), rr, $fd);\n        oldEl[DESTROY]();\n        roots[index] = newEl;\n        keys[index] = newKey;\n        newEl[HANDLE_AFTER_RENDER]();\n        // console.log('update item render:', index);\n      } else {\n        oldEl.each = item;\n      }\n    } else {\n      oldEl.each = item;\n    }\n  }\n\n  [UPDATE]() {\n    this[FOR_WAIT_UPDATE] = false;\n    // console.log('for update');\n    const itemRenderFn = this[ARG_COMPONENTS] ? this[ARG_COMPONENTS][STR_DEFAULT] : null;\n    if (!itemRenderFn) return;\n\n    const newItems = isArray(this.loop) ? this.loop : EMP_ARR;\n    const roots = this[ROOT_NODES];\n    const nl = newItems.length;\n    const ol = this[FOR_LENGTH];\n    // nothing changed, return directly.\n    if (nl === 0 && ol === 0) return;\n\n    const keyName = this[FOR_KEY_NAME];\n    // if new length equal 0, clear & render comment.\n    if (nl === 0 && ol > 0) {\n      const fd = roots[0][GET_FIRST_DOM]();\n      const $cmt = createComment(STR_EMPTY);\n      insertBefore(getParent(fd), $cmt, fd);\n      for (let i = 0; i < ol; i++) {\n        roots[i][DESTROY]();\n      }\n      roots.length = 1;\n      roots[0] = $cmt;\n      if (keyName !== KEY_INDEX) {\n        this[FOR_KEYS].length = 0;\n      }\n      this[FOR_LENGTH] = 0;\n      return;\n    }\n\n    this[FOR_LENGTH] = nl;\n    const ctx = this[CONTEXT];\n    const cstyPid = this[CSTYLE_PID];\n    const firstEl = roots[0]; // if ol === 0, firstEl is comment, else is component\n    const $parent = getParent(ol === 0 ? firstEl : firstEl[GET_FIRST_DOM]());\n\n    if (keyName === KEY_INDEX) {\n      let $f = null;\n      if (ol === 0) roots.length = 0;\n\n      for (let i = 0; i < nl; i++) {\n        if (i < ol) {\n          updateEl(roots[i], i, newItems);\n        } else {\n          if (!$f) $f = createFragment();\n          appendChild($f, ...appendRenderEach(newItems[i], i, i === nl - 1, itemRenderFn, roots, ctx, cstyPid));\n        }\n      }\n      if ($f) {\n        const $le = ol === 0 ? firstEl : roots[ol - 1][GET_LAST_DOM]();\n        insertAfter($parent, $f, $le);\n        for (let i = ol; i < nl; i++) {\n          roots[i][HANDLE_AFTER_RENDER]();\n        }\n      }\n      if (ol === 0) {\n        removeChild($parent, firstEl);\n      }\n      if (nl >= ol) return;\n      for (let i = nl; i < ol; i++) {\n        roots[i][DESTROY]();\n      }\n      roots.splice(nl);\n\n      return;\n    }\n\n    const oldKeys = this[FOR_KEYS];\n    if (ol === 0) {\n      roots.length = 0;\n      const rs = renderItems(\n        newItems, itemRenderFn, roots,\n        oldKeys, keyName, this[CONTEXT], this[CSTYLE_PID]\n      );\n      insertAfter($parent, createFragment(rs), firstEl);\n      removeChild($parent, firstEl);\n      roots.forEach(el => el[HANDLE_AFTER_RENDER]());\n      return;\n    }\n\n    const oldKeyMap = new Map();\n    oldKeys.forEach((k, i) => {\n      oldKeyMap.set(k, i);\n    });\n    const newKeys = [];\n    const newKeyMap = new Map();\n    newItems.forEach((item, i) => {\n      _assertVm(item, i);\n      newKeys.push(_prepareKey(item, i, newKeyMap, keyName));\n    });\n\n    let oi = 0;\n    let ni = 0;\n    let $lastS = null;\n    const newRoots = [];\n    const oldTags = new Uint8Array(ol);\n    while (oi < ol || ni < nl) {\n      while (oi < ol) {\n        if (oldTags[oi] !== 0) {\n          oi++;\n        } else if (newKeyMap.has(oldKeys[oi]) && newKeyMap.get(oldKeys[oi]) >= ni) {\n          if (oi === ol - 1) {\n            $lastS = roots[oi][GET_LAST_DOM]().nextSibling;\n          }\n          break;\n        } else {\n          if (oi === ol - 1) {\n            $lastS = roots[oi][GET_LAST_DOM]().nextSibling;\n          }\n          roots[oi][DESTROY]();\n          oi++;\n        }\n      }\n      if (oi >= ol) {\n        let $f = null;\n        const cei = newRoots.length;\n        for (; ni < nl; ni++) {\n          const el = createEl(newItems[ni], ni, ni === nl - 1, itemRenderFn, ctx, cstyPid);\n          if (!$f) $f = createFragment();\n          appendChild($f, ...el[RENDER]());\n          newRoots.push(el);\n        }\n        if ($f) {\n          if ($lastS) {\n            insertBefore($parent, $f, $lastS);\n          } else {\n            appendChild($parent, $f);\n          }\n          for (let i = cei; i < newRoots.length; i++) {\n            newRoots[i][HANDLE_AFTER_RENDER]();\n          }\n        }\n        break;\n      }\n      const oldKey = oldKeys[oi];\n      let $f = null;\n      let $nes = null;\n      while (ni < nl) {\n        const newKey = newKeys[ni];\n        if (newKey === oldKey) break;\n\n        let reuseEl = null;\n        if (oldKeyMap.has(newKey)) {\n          const oldIdx = oldKeyMap.get(newKey);\n          if (oldIdx > oi && oldTags[oldIdx] === 0) {\n            reuseEl = roots[oldIdx];\n            oldTags[oldIdx] = 1;\n          }\n        }\n        if (!$f) $f = createFragment();\n        if (!reuseEl) {\n          reuseEl = createEl(newItems[ni], ni, ni === nl - 1, itemRenderFn, ctx, cstyPid);\n          appendChild($f, ...reuseEl[RENDER]());\n          if (!$nes) $nes = [];\n          $nes.push(reuseEl);\n        } else {\n          loopAppend($f, reuseEl);\n          updateEl(reuseEl, ni, newItems);\n        }\n        newRoots.push(reuseEl);\n        ni++;\n      }\n      if (ni >= nl) {\n        assertFail('unimpossible?!');\n      }\n      const el = roots[oi];\n      $f && insertBefore($parent, $f, el[GET_FIRST_DOM]());\n      $nes && $nes.forEach(el => el[HANDLE_AFTER_RENDER]());\n      updateEl(el, ni, newItems);\n      newRoots.push(el);\n      oi++;\n      ni++;\n    }\n\n    this[ROOT_NODES] = newRoots;\n    this[FOR_KEYS] = newKeys;\n  }\n}\n","\nimport {\n  VM_ATTRS as VM_ATTRS_b36c9d60a9,\n  VM_ON as VM_ON_b36c9d60a9,\n  wrapComponent as wrapComponent_b36c9d60a9\n} from '..';\nimport {\n  Component,\n  RENDER,\n  DESTROY,\n  ARG_COMPONENTS,\n  UPDATE_IF_NEED,\n  UPDATE,\n  ROOT_NODES,\n  HANDLE_AFTER_RENDER,\n  GET_FIRST_DOM,\n  CONTEXT,\n  isComponent,\n  GET_TRANSITION_DOM,\n  BEFORE_DESTROY,\n  NOTIFY,\n  TS_STATE_ENTERED,\n  TS_STATE_LEAVED,\n  TS_STATE_LEAVING,\n  TS_STATE_ENTERING,\n  TS_ENTER,\n  TS_LEAVE,\n  TS_TRANSITION,\n  TS_LEAVE_CANCELLED,\n  TS_ENTER_CANCELLED,\n  TS_BEFORE_ENTER,\n  TS_BEFORE_LEAVE,\n  TS_TRANSITION_END,\n  TS_ANIMATION_END,\n  TS_AFTER_ENTER,\n  TS_AFTER_LEAVE,\n  TS_C_ENTER,\n  TS_C_LEAVE,\n  TS_C_ENTER_ACTIVE,\n  TS_C_LEAVE_ACTIVE,\n  getDurationType,\n  addParentStyleId,\n  CSTYLE_PID\n} from '../core';\nimport {\n  createComment,\n  getParent,\n  removeChild,\n  insertBefore,\n  removeClass,\n  removeEvent,\n  addClass,\n  addEvent,\n  STR_DEFAULT,\n  STR_EMPTY,\n  Symbol,\n  setImmediate\n} from '../util';\nimport {\n  wrapAttrs,\n  VM_DEBUG_NAME,\n  VM_ATTRS\n} from '../vm';\n\nconst IF_STR_ELSE = 'else';\nconst T_MAP = Symbol();\nconst P_VAL = Symbol();\nconst OE_H = Symbol();\n\nconst C_BV = Symbol();\nconst C_VAL = Symbol();\nconst ON_TS_END = Symbol();\n\nfunction createEl(renderFn, context, parentStyleIds) {\n  const el = new Component(wrapAttrs({\n    [VM_DEBUG_NAME]: 'attrs_of_<if>',\n    [VM_ATTRS]: null,\n    [CONTEXT]: context,\n    [ARG_COMPONENTS]: {\n      [STR_DEFAULT]: renderFn\n    }\n  }));\n  parentStyleIds && addParentStyleId(el, parentStyleIds);\n  return el;\n}\n\nfunction renderSwitch(component) {\n  const value = component[C_VAL];\n  const acs = component[ARG_COMPONENTS];\n  if (component.ts && acs) {\n    const t = new Map();\n    for (const k in acs) {\n      t.set(k, [\n        k === value ? TS_STATE_ENTERED : TS_STATE_LEAVED,\n        null // element\n      ]);\n    }\n    component[T_MAP] = t;\n    component[P_VAL] = value;\n    component[OE_H] = component[ON_TS_END].bind(component);\n  }\n  const renderFn = acs ? acs[value] : null;\n  const roots = component[ROOT_NODES];\n  if (!renderFn) {\n    roots.push(createComment(STR_EMPTY));\n    return roots;\n  }\n  const el = createEl(renderFn, component[CONTEXT], component[CSTYLE_PID]);\n  roots.push(el);\n  return el[RENDER]();\n}\n\nfunction updateSwitch(component) {\n  if (!isComponent(component[ROOT_NODES][0]) && (\n    !component[ARG_COMPONENTS] || !component[ARG_COMPONENTS][component[C_VAL]]\n  )) {\n    return;\n  }\n\n  if (component[T_MAP]) {\n    return updateSwitchWithTransition(component);\n  }\n\n  doUpdate(component);\n}\n\nfunction doUpdate(component) {\n  const roots = component[ROOT_NODES];\n  const el = roots[0];\n  const isC = isComponent(el);\n  const fd = isC ? el[GET_FIRST_DOM]() : el;\n  const pa = getParent(isC ? fd : el);\n  const renderFn = component[ARG_COMPONENTS] ? component[ARG_COMPONENTS][component[C_VAL]] : null;\n  const ne = renderFn ? createEl(renderFn, component[CONTEXT], component[CSTYLE_PID]) : null;\n  roots[0] = ne || createComment(STR_EMPTY);\n  insertBefore(\n    pa,\n    ne ? ne[RENDER]() : roots[0],\n    fd\n  );\n  if (isC) {\n    el[DESTROY]();\n  } else {\n    removeChild(pa, fd);\n  }\n  ne && renderFn && ne[HANDLE_AFTER_RENDER]();\n  component[NOTIFY]('branch-switched', component[C_BV]);\n}\n\nfunction cancelTs(t, tn, e, component) {\n  const el = t[1];\n  if (el.nodeType !== Node.ELEMENT_NODE) {\n    return;\n  }\n  const onEnd = component[OE_H];\n  removeClass(el, tn + (e ? TS_C_ENTER : TS_C_LEAVE));\n  removeClass(el, tn + (e ? TS_C_ENTER_ACTIVE : TS_C_LEAVE_ACTIVE));\n  removeEvent(el, TS_TRANSITION_END, onEnd);\n  removeEvent(el, TS_ANIMATION_END, onEnd);\n  component[NOTIFY](TS_TRANSITION, e ? TS_ENTER_CANCELLED : TS_LEAVE_CANCELLED, el);\n}\n\nfunction startTs(t, tn, e, component) {\n  const el = t[1];\n  const onEnd = component[OE_H];\n  if (el.nodeType !== Node.ELEMENT_NODE) {\n    onEnd();\n    return;\n  }\n  const classOfStart = tn + (e ? TS_C_ENTER : TS_C_LEAVE);\n  const classOfActive = tn + (e ? TS_C_ENTER_ACTIVE : TS_C_LEAVE_ACTIVE);\n\n  addClass(el, classOfStart);\n  // force render by calling getComputedStyle\n  getDurationType(el);\n  addClass(el, classOfActive);\n  const tsEndName = getDurationType(el);\n  if (!tsEndName) {\n    onEnd();\n    return;\n  }\n  t[0] = e ? TS_STATE_ENTERING : TS_STATE_LEAVING;\n  addEvent(el, tsEndName, onEnd);\n  component[NOTIFY](TS_TRANSITION, e ? TS_BEFORE_ENTER : TS_BEFORE_LEAVE, el);\n  setImmediate(() => {\n    component[NOTIFY](TS_TRANSITION, e ? TS_ENTER : TS_LEAVE, el);\n  });\n}\nfunction updateSwitchWithTransition(component) {\n  const value = component[C_VAL];\n  const pv = component[P_VAL];\n  const tn = component.ts;\n  let pt = component[T_MAP].get(pv);\n  if (!pt) {\n    pt = [\n      pv === IF_STR_ELSE ? TS_STATE_LEAVED : TS_STATE_ENTERED,\n      null // element\n    ];\n    component[T_MAP].set(pv, pt);\n  }\n  // debugger;\n  if (pt[0] === TS_STATE_ENTERING) {\n    if (value === pv) return;\n    cancelTs(pt, tn, true, component);\n    startTs(pt, tn, false, component);\n  } else if (pt[0] === TS_STATE_LEAVING) {\n    if (value !== pv) return;\n    cancelTs(pt, tn, false, component);\n    startTs(pt, tn, true, component);\n  } else if (pt[0] === TS_STATE_ENTERED) {\n    pt[1] = component[GET_TRANSITION_DOM]();\n    startTs(pt, tn, false, component);\n  } else if (pt[0] === TS_STATE_LEAVED) {\n    pt[1] = component[GET_TRANSITION_DOM]();\n    startTs(pt, tn, true, component);\n  }\n}\n\nfunction updateSwitchOnTransitionEnd(component) {\n  // console.log('on end')\n  const value = component[C_VAL];\n  const pv = component[P_VAL];\n  const tn = component.ts;\n  const pt = component[T_MAP].get(pv);\n  const e = pt[0] === TS_STATE_ENTERING;\n  const el = pt[1];\n\n  if (el.nodeType === Node.ELEMENT_NODE) {\n    removeEvent(el, TS_TRANSITION_END, component[OE_H]);\n    removeEvent(el, TS_ANIMATION_END, component[OE_H]);\n    removeClass(el, tn + (e ? TS_C_ENTER : TS_C_LEAVE));\n    removeClass(el, tn + (e ? TS_C_ENTER_ACTIVE : TS_C_LEAVE_ACTIVE));\n    component[NOTIFY](TS_TRANSITION, e ? TS_AFTER_ENTER : TS_AFTER_LEAVE);\n  }\n\n  pt[0] = e ? TS_STATE_ENTERED : TS_STATE_LEAVED;\n\n  if (e) return;\n\n  doUpdate(component);\n  component[P_VAL] = value;\n  const ct = component[T_MAP].get(value);\n  if (!ct) {\n    return;\n  }\n  const fd = component[GET_TRANSITION_DOM]();\n  if (fd.nodeType !== Node.ELEMENT_NODE) {\n    ct[0] = TS_STATE_ENTERED;\n    return;\n  }\n\n  ct[1] = fd;\n  startTs(ct, tn, true, component);\n}\n\nfunction destroySwitch(component) {\n  const tMap = component[T_MAP];\n  if (tMap) {\n    tMap.forEach((ts, v) => {\n      if (ts[1]) {\n        removeEvent(ts[1], TS_TRANSITION_END, component[OE_H]);\n        removeEvent(ts[1], TS_ANIMATION_END, component[OE_H]);\n      }\n      ts.length = 0;\n    });\n    tMap.clear();\n  }\n}\n\nexport class IfComponent extends Component {\n  constructor(attrs) {\n    const vm_b36c9d60a9 = super(attrs);\n    vm_b36c9d60a9[C_VAL] = STR_DEFAULT;\n    vm_b36c9d60a9[OE_H] = null;\n    vm_b36c9d60a9[T_MAP] = null;\n    vm_b36c9d60a9[P_VAL] = null;\n    const fn_b36c9d60a9_5 = () => {\n      vm_b36c9d60a9.expect = attrs.expect;\n    };\n    fn_b36c9d60a9_5();\n    attrs[VM_ATTRS_b36c9d60a9][VM_ON_b36c9d60a9]('expect', fn_b36c9d60a9_5);\n    const fn_b36c9d60a9_6 = () => {\n      vm_b36c9d60a9.ts = attrs.transition;\n    };\n    fn_b36c9d60a9_6();\n    attrs[VM_ATTRS_b36c9d60a9][VM_ON_b36c9d60a9]('transition', fn_b36c9d60a9_6);\n    return vm_b36c9d60a9;\n  }\n\n  get expect() {\n    return this[C_VAL] === STR_DEFAULT;\n  }\n\n  set expect(v) {\n    v = v ? STR_DEFAULT : IF_STR_ELSE;\n    if (this[C_VAL] === v) return;\n    this[C_VAL] = v;\n    this[UPDATE_IF_NEED]();\n  }\n\n  get [C_BV]() {\n    return this.expect;\n  }\n\n  [ON_TS_END]() {\n    updateSwitchOnTransitionEnd(this);\n  }\n\n  [RENDER]() {\n    return renderSwitch(this);\n  }\n\n  [UPDATE]() {\n    updateSwitch(this);\n  }\n\n  [BEFORE_DESTROY]() {\n    destroySwitch(this);\n  }\n}\n\nexport class SwitchComponent extends Component {\n  constructor(attrs) {\n    const vm_b36c9d60a9 = super(attrs);\n    vm_b36c9d60a9[OE_H] = null;\n    vm_b36c9d60a9[T_MAP] = null;\n    vm_b36c9d60a9[P_VAL] = null;\n    const fn_b36c9d60a9_4 = () => {\n      vm_b36c9d60a9.test = attrs.test;\n    };\n    fn_b36c9d60a9_4();\n    attrs[VM_ATTRS_b36c9d60a9][VM_ON_b36c9d60a9]('test', fn_b36c9d60a9_4);\n    const fn_b36c9d60a9_5 = () => {\n      vm_b36c9d60a9.ts = attrs.transition;\n    };\n    fn_b36c9d60a9_5();\n    attrs[VM_ATTRS_b36c9d60a9][VM_ON_b36c9d60a9]('transition', fn_b36c9d60a9_5);\n    return vm_b36c9d60a9;\n  }\n\n  get test() {\n    return this[C_VAL];\n  }\n\n  set test(v) {\n    const acs = this[ARG_COMPONENTS];\n    if (!acs || !(v in acs)) {\n      v = STR_DEFAULT;\n    }\n    if (this[C_VAL] === v) return;\n    this[C_VAL] = v;\n    this[UPDATE_IF_NEED]();\n  }\n\n  get [C_BV]() {\n    return this.test;\n  }\n\n  [ON_TS_END]() {\n    updateSwitchOnTransitionEnd(this);\n  }\n\n  [RENDER]() {\n    return renderSwitch(this);\n  }\n\n  [UPDATE]() {\n    updateSwitch(this);\n  }\n\n  [BEFORE_DESTROY]() {\n    destroySwitch(this);\n  }\n}\n","\nimport {\n  VM_ATTRS as VM_ATTRS_b36c9d60a9,\n  VM_ON as VM_ON_b36c9d60a9,\n  wrapComponent as wrapComponent_b36c9d60a9\n} from '..';\n\nimport {\n  Component,\n  RENDER,\n  UPDATE,\n  BEFORE_DESTROY,\n  UPDATE_IF_NEED,\n  HANDLE_BEFORE_DESTROY,\n  GET_LAST_DOM,\n  i18n as i18nService,\n  I18N_GET_RENDER,\n  I18N_WATCH\n} from '../core';\nimport {\n  getParent,\n  insertBefore,\n  appendChild\n} from '../util';\nimport {\n  vmRelatedClear,\n  VM_RELATED_LISTENERS\n} from '../vm';\n\nconst RENDER_KEY = Symbol('render_key');\nconst RENDER_VMS = Symbol('render_vms');\nconst ON_LOCALE_CHANGE = Symbol('fn_on_locale_change');\n\nexport class I18nComponent extends Component {\n  constructor(attrs, renderKey, renderVms) {\n    const vm_b36c9d60a9 = super(attrs);\n    vm_b36c9d60a9[RENDER_KEY] = renderKey;\n    vm_b36c9d60a9[RENDER_VMS] = renderVms;\n    vm_b36c9d60a9[I18N_WATCH](vm_b36c9d60a9[ON_LOCALE_CHANGE]);\n    return vm_b36c9d60a9;\n  }\n\n  [RENDER]() {\n    const renderFn = i18nService[I18N_GET_RENDER](this[RENDER_KEY]);\n    return renderFn(this, ...this[RENDER_VMS]);\n  }\n\n  [ON_LOCALE_CHANGE]() {\n    this[UPDATE_IF_NEED]();\n  }\n\n  [UPDATE]() {\n    vmRelatedClear(this[VM_RELATED_LISTENERS]);\n\n    let $el = this[GET_LAST_DOM]();\n    const $parentEl = getParent($el);\n    $el = $el.nextSibling;\n\n    /*\n     * 当前实现下，HANDLE_BEFORE_DESTROY 正好可以销毁子组件/子元素。\n     */\n    this[HANDLE_BEFORE_DESTROY](true);\n    /*\n     * 将新的元素替换到原来的旧的元素的位置。\n     */\n    const els = this[RENDER]();\n    if ($el) {\n      insertBefore($parentEl, els, $el);\n    } else {\n      appendChild($parentEl, els);\n    }\n  }\n\n  [BEFORE_DESTROY]() {\n    this[RENDER_VMS] = null; // unlink vms, maybe not necessary\n  }\n}\n","import {\n  createElement as createElement_a8c613b8, CSTYLE_PID as CSTYLE_PID_a8c613b8, ROOT_NODES as ROOT_NODES_a8c613b8\n} from 'jinge';\nexport default function(component) {\n  const vm_0 = component;\n  return [\n  (() => {\n    const el = createElement_a8c613b8(\n      \"div\",\n      component[CSTYLE_PID_a8c613b8],\n      \"Hello, World\"\n    );\n    component[ROOT_NODES_a8c613b8].push(el);\n    return el;\n  })()\n  ];\n}","import {\n  assertFail\n} from '../util';\nimport {\n  wrapAttrs\n} from '../vm';\nimport {\n  RENDER_TO_DOM,\n  isComponent\n} from './component';\n\nexport function bootstrap(Component, dom, attrs) {\n  if (dom === document.body) {\n    throw new Error('bootstrap dom cannot be document.body');\n  }\n  /**\n   * as we must pass ViewModel-Object as first argument to Component constructor,\n   * we simple pass an empty attrs.\n   */\n  const bootAttrs = attrs || {};\n  const bootComponent = new Component(wrapAttrs(bootAttrs));\n  if (!isComponent(bootComponent)) assertFail();\n  bootComponent[RENDER_TO_DOM](dom);\n}\n","import {\n  Component,\n  bootstrap\n} from 'jinge';\n\nimport _tpl from './app.html';\n\nclass App extends Component {\n  static get template() {\n    return _tpl;\n  }\n}\n\nbootstrap(App, document.getElementById('root-app'));\n"],"sourceRoot":""}